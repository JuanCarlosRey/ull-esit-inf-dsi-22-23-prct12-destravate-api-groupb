<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>doc-test</title><meta name="description" content="Documentation for doc-test"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os"</script><header class="tsd-page-toolbar">
<div class="tsd-toolbar-contents container">
<div class="table-cell" id="tsd-search" data-base=".">
<div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M15.7824 13.833L12.6666 10.7177C12.5259 10.5771 12.3353 10.499 12.1353 10.499H11.6259C12.4884 9.39596 13.001 8.00859 13.001 6.49937C13.001 2.90909 10.0914 0 6.50048 0C2.90959 0 0 2.90909 0 6.49937C0 10.0896 2.90959 12.9987 6.50048 12.9987C8.00996 12.9987 9.39756 12.4863 10.5008 11.6239V12.1332C10.5008 12.3332 10.5789 12.5238 10.7195 12.6644L13.8354 15.7797C14.1292 16.0734 14.6042 16.0734 14.8948 15.7797L15.7793 14.8954C16.0731 14.6017 16.0731 14.1267 15.7824 13.833ZM6.50048 10.499C4.29094 10.499 2.50018 8.71165 2.50018 6.49937C2.50018 4.29021 4.28781 2.49976 6.50048 2.49976C8.71001 2.49976 10.5008 4.28708 10.5008 6.49937C10.5008 8.70852 8.71314 10.499 6.50048 10.499Z" fill="var(--color-text)"></path></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div>
<div class="field">
<div id="tsd-toolbar-links"></div></div>
<ul class="results">
<li class="state loading">Preparing search index...</li>
<li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">doc-test</a></div>
<div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="1" y="3" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="7" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="11" width="14" height="2" fill="var(--color-text)"></rect></svg></a></div></div></header>
<div class="container container-main">
<div class="col-8 col-content">
<div class="tsd-page-title">
<h2>doc-test</h2></div>
<div class="tsd-panel tsd-typography">
<a href="#informe-practica-12" id="informe-practica-12" style="color: inherit; text-decoration: none;">
  <h1>Informe Practica 12</h1>
</a>

<a href="#grupo-b" id="grupo-b" style="color: inherit; text-decoration: none;">
  <h2>Grupo B</h2>
</a>
<ul>
<li>Juan Carlos Rey Medina<ul>
<li>alu0101410869</li>
</ul>
</li>
<li>Cristopher Alexandro Medina Peschiutta<ul>
<li>alu0101333281</li>
</ul>
</li>
<li>Ancor González Carballo<ul>
<li>alu0101327679</li>
</ul>
</li>
</ul>

<a href="#introducción" id="introducción" style="color: inherit; text-decoration: none;">
  <h2>Introducción</h2>
</a>
<p>En esta segunda práctica grupal de la asignatura se ha llevado a cabo un API REST, haciendo uso de Node/Express, que permita llevar a cabo operaciones de creación, lectura, modificación y borrado (Create, Read, Update, Delete - CRUD) de un registro de actividades deportivas. Se hara uso de MongoDB, Mongoose y cyclic.</p>

<a href="#tareas-previas" id="tareas-previas" style="color: inherit; text-decoration: none;">
  <h2>Tareas previas</h2>
</a>
<ul>
<li><p>Peparar el entorno virtual para que contenga:</p>
<ol>
<li><a href="https://typedoc.org">TyeDoc</a></li>
<li><a href="https://mochajs.org">Mocha</a></li>
<li><a href="https://www.chaijs.com">Chai</a></li>
<li>Prettier</li>
<li>eslint</li>
<li><a href="https://istanbul.js.org/">Instanbull</a></li>
<li><a href="https://coveralls.io/">Coveralls</a></li>
<li><a href="https://www.npmjs.com/package/prompt-sync">Prompt-sync</a><ul>
<li><code>npm i prompt-sync</code></li>
<li><code>npm i --save-dev @types/prompt-sync</code></li>
</ul>
</li>
<li><a href="https://www.npmjs.com/package/yargs">Yargs</a></li>
<li><a href="https://www.npmjs.com/package/chalk">Chalks</a></li>
<li>GitHub Actions<ul>
<li>Pages</li>
<li>Coveralls</li>
<li>SonarCloud</li>
</ul>
</li>
<li>Entender un poco el <a href="https://nodejs.org/docs/latest-v19.x/api/fs.html">API sincrona de Node.js</a></li>
<li><a href="https://www.mongodb.com/cloud/atlas/lp/try4?utm_source=google&utm_campaign=search_gs_pl_evergreen_atlas_core_prosp-brand_gic-null_emea-es_ps-all_desktop_eng_lead&utm_term=mongodb&utm_medium=cpc_paid_search&utm_ad=e&utm_ad_campaign_id=12212624563&adgroup=115749706983&cq_cmp=12212624563&gad=1&gclid=Cj0KCQjwpPKiBhDvARIsACn-gzCQHOJICmBBlepfO_tXL56MSFr49BQzigSruRPp-eqpa3jtGzWgjPIaAgYCEALw_wcB">MongoDB</a></li>
<li><a href="https://www.cyclic.sh/">cyclic</a></li>
</ol>
</li>
<li><p>Tener a mano el <a href="https://github.com/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct12-destravate-api-groupb.git">guion de la practica</a></p>
</li>
</ul>

<a href="#proyecto" id="proyecto" style="color: inherit; text-decoration: none;">
  <h2>Proyecto</h2>
</a>

<a href="#db" id="db" style="color: inherit; text-decoration: none;">
  <h3>db</h3>
</a>
<pre><code class="language-ts"><span class="hl-0">/**</span><br/><span class="hl-0"> * Conecta a un servidor de base de datos MongoDB.</span><br/><span class="hl-0"> * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-2">uri</span><span class="hl-0"> - La URL del servidor de base de datos MongoDB.</span><br/><span class="hl-0"> * </span><span class="hl-1">@returns</span><span class="hl-0"> Una promesa que se resuelve con nada si la conexión es exitosa.</span><br/><span class="hl-0"> * </span><span class="hl-1">@throws</span><span class="hl-0"> Si la conexión no puede establecerse o hay un error en la conexión.</span><br/><span class="hl-0"> */</span><br/><span class="hl-1">declare</span><span class="hl-3"> </span><span class="hl-1">function</span><span class="hl-3"> </span><span class="hl-4">connect</span><span class="hl-3">(</span><span class="hl-2">uri</span><span class="hl-3">: </span><span class="hl-5">string</span><span class="hl-3">): </span><span class="hl-5">Promise</span><span class="hl-3">&lt;</span><span class="hl-5">void</span><span class="hl-3">&gt;;</span><br/><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Intenta conectarse a un servidor de base de datos MongoDB que se ejecuta localmente.</span><br/><span class="hl-0"> */</span><br/><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-4">connect</span><span class="hl-3">(</span><span class="hl-7">&quot;mongodb://127.0.0.1:27017/sports-app&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">  </span><span class="hl-2">console</span><span class="hl-3">.</span><span class="hl-4">log</span><span class="hl-3">(</span><span class="hl-7">&quot;Connection to MongoDB server established&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">} </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">  </span><span class="hl-2">console</span><span class="hl-3">.</span><span class="hl-4">log</span><span class="hl-3">(</span><span class="hl-7">&quot;Unable to connect to MongoDB server&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">}</span>
</code></pre>
<p>El código define una función <code>connect</code> que acepta una URL de servidor de base de datos MongoDB como parámetro y devuelve una promesa que se resuelve sin nada si la conexión es exitosa. La función <code>connect</code> también puede lanzar una excepción si la conexión no puede establecerse o hay un error en la conexión.</p>
<p>En el bloque <code>try</code>, el código intenta conectarse a un servidor de base de datos MongoDB que se ejecuta localmente en <code>mongodb://127.0.0.1:27017/sports-app</code>. Si la conexión se establece correctamente, se imprimirá el mensaje &quot;Connection to MongoDB server established&quot; en la consola. Si hay algún error al conectarse, se imprimirá el mensaje &quot;Unable to connect to MongoDB server&quot; en la consola.</p>

<a href="#interfaces" id="interfaces" style="color: inherit; text-decoration: none;">
  <h3>Interfaces</h3>
</a>
<p>El codigo del fichero challenge.ts es:</p>
<pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">Type</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;./track.js&quot;</span><span class="hl-3">;</span><br/><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">Document</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;mongoose&quot;</span><span class="hl-3">;</span><br/><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Representa un desafío en la base de datos.</span><br/><span class="hl-0"> */</span><br/><span class="hl-6">export</span><span class="hl-3"> </span><span class="hl-1">interface</span><span class="hl-3"> </span><span class="hl-5">ChallengeDocument</span><span class="hl-3"> </span><span class="hl-1">extends</span><span class="hl-3"> </span><span class="hl-5">Document</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * El ID del desafío.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">id</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * El nombre del desafío.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">name</span><span class="hl-3">: </span><span class="hl-5">string</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Los ID de las pistas asociadas con el desafío.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">tracks</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">[];</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * El tipo de desafío.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">type</span><span class="hl-3">: </span><span class="hl-5">Type</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * La longitud del desafío en metros.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">long</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Los usuarios que han participado en el desafío.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">users</span><span class="hl-3">: </span><span class="hl-5">string</span><span class="hl-3">[];</span><br/><span class="hl-3">}</span>
</code></pre>
<p>El código define una interfaz TypeScript llamada &quot;ChallengeDocument&quot; que representa un desafío en la base de datos. La interfaz extiende la interfaz &quot;Document&quot; de Mongoose, lo que significa que puede ser utilizada para definir el modelo de datos de un documento en la base de datos MongoDB.</p>
<p>La interfaz tiene propiedades que describen el desafío, incluyendo un ID, nombre, ID de pistas asociadas con el desafío, tipo de desafío, longitud del desafío en metros, y una lista de usuarios que han participado en el desafío. </p>
<p>La propiedad &quot;type&quot; es de un tipo personalizado llamado &quot;Type&quot;, que se importa del módulo &quot;track.js&quot;.</p>
<p>El codigo del fichero group.ts es:</p>
<pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">Statistics</span><span class="hl-3">, </span><span class="hl-2">Record</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;./user.js&quot;</span><span class="hl-3">;</span><br/><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">Document</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;mongoose&quot;</span><span class="hl-3">;</span><br/><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Representa un grupo en la base de datos.</span><br/><span class="hl-0"> */</span><br/><span class="hl-6">export</span><span class="hl-3"> </span><span class="hl-1">interface</span><span class="hl-3"> </span><span class="hl-5">GroupDocument</span><span class="hl-3"> </span><span class="hl-1">extends</span><span class="hl-3"> </span><span class="hl-5">Document</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * El ID del grupo.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">id</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * El nombre del grupo.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">name</span><span class="hl-3">: </span><span class="hl-5">string</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Los ID de los miembros del grupo.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">members</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">[];</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Las estadísticas globales del grupo.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">global_statistics</span><span class="hl-3">: </span><span class="hl-5">Statistics</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * El ranking de los miembros del grupo ordenado por cantidad de km o por desnivel.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">ranking</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">[];</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Los ID de las pistas favoritas del grupo.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">favorite_tracks</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">[];</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * El historial de actividades del grupo.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">group_history</span><span class="hl-3">: </span><span class="hl-5">Record</span><span class="hl-3">;</span><br/><span class="hl-3">}</span>
</code></pre>
<p>Este código define una interfaz TypeScript llamada <code>GroupDocument</code> que representa un grupo en la base de datos. La interfaz tiene varias propiedades que definen los datos asociados con el grupo. Estas propiedades incluyen:</p>
<ul>
<li><code>id</code>: el ID del grupo</li>
<li><code>name</code>: el nombre del grupo</li>
<li><code>members</code>: un array con los IDs de los miembros del grupo</li>
<li><code>global_statistics</code>: un objeto que contiene las estadísticas globales del grupo, definidas en otra interfaz llamada <code>Statistics</code></li>
<li><code>ranking</code>: un array con los IDs de los miembros del grupo ordenados por cantidad de km o desnivel.</li>
<li><code>favorite_tracks</code>: un array con los IDs de las pistas favoritas del grupo</li>
<li><code>group_history</code>: un objeto que contiene el historial de actividades del grupo, definido en otra interfaz llamada <code>Record</code>.</li>
</ul>
<p>Además, esta interfaz utiliza la interfaz <code>Document</code> proporcionada por Mongoose para definir que este objeto es un documento de base de datos.</p>
<p>El codigo del fichero track.ts es:</p>
<pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">Document</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;mongoose&quot;</span><span class="hl-3">;</span><br/><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Enum que define los posibles tipos de pista.</span><br/><span class="hl-0"> */</span><br/><span class="hl-6">export</span><span class="hl-3"> </span><span class="hl-1">enum</span><span class="hl-3"> </span><span class="hl-5">Type</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-8">correr</span><span class="hl-3"> = </span><span class="hl-7">&quot;correr&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">  </span><span class="hl-8">bicicleta</span><span class="hl-3"> = </span><span class="hl-7">&quot;bicicleta&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">}</span><br/><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Representa las coordenadas de un punto en el mapa.</span><br/><span class="hl-0"> */</span><br/><span class="hl-6">export</span><span class="hl-3"> </span><span class="hl-1">type</span><span class="hl-3"> </span><span class="hl-5">Coordinates</span><span class="hl-3"> = {</span><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * La latitud de las coordenadas.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">lat</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * La longitud de las coordenadas.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">long</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * La altitud de las coordenadas.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">alt</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><span class="hl-3">};</span><br/><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Representa una pista en la base de datos.</span><br/><span class="hl-0"> */</span><br/><span class="hl-6">export</span><span class="hl-3"> </span><span class="hl-1">interface</span><span class="hl-3"> </span><span class="hl-5">TrackDocument</span><span class="hl-3"> </span><span class="hl-1">extends</span><span class="hl-3"> </span><span class="hl-5">Document</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * El ID de la pista.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">id</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * El nombre de la pista.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">name</span><span class="hl-3">: </span><span class="hl-5">string</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Las coordenadas del punto de inicio de la pista.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">start</span><span class="hl-3">: </span><span class="hl-5">Coordinates</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Las coordenadas del punto final de la pista.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">end</span><span class="hl-3">: </span><span class="hl-5">Coordinates</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * La longitud de la pista en metros.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">long</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * El grado de inclinación de la pista en porcentaje.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">grade</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Los ID de los usuarios que han registrado actividades en la pista.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">users</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">[];</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * El tipo de pista.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">type</span><span class="hl-3">: </span><span class="hl-5">Type</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * La puntuación de la pista.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">puntuation</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><span class="hl-3">}</span>
</code></pre>
<p>Este código define la estructura de una pista en la base de datos de la aplicación. La pista está representada por una interfaz <code>TrackDocument</code> que extiende la clase <code>Document</code> de Mongoose. La interfaz define los siguientes atributos de una pista:</p>
<ul>
<li><code>id</code>: el ID de la pista.</li>
<li><code>name</code>: el nombre de la pista.</li>
<li><code>start</code>: las coordenadas del punto de inicio de la pista.</li>
<li><code>end</code>: las coordenadas del punto final de la pista.</li>
<li><code>long</code>: la longitud de la pista en metros.</li>
<li><code>grade</code>: el grado de inclinación de la pista en porcentaje.</li>
<li><code>users</code>: los ID de los usuarios que han registrado actividades en la pista.</li>
<li><code>type</code>: el tipo de pista (correr o bicicleta).</li>
<li><code>puntuation</code>: la puntuación de la pista.</li>
</ul>
<p>Además, el código define un enum <code>Type</code> que define los posibles tipos de pista y un tipo <code>Coordinates</code> que representa las coordenadas de un punto en el mapa.</p>
<p>El codigo del fichero user.ts es:</p>
<pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">Type</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;./track.js&quot;</span><span class="hl-3">;</span><br/><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">Document</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;mongoose&quot;</span><span class="hl-3">;</span><br/><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Representa las estadísticas de actividad de un usuario.</span><br/><span class="hl-0"> */</span><br/><span class="hl-6">export</span><span class="hl-3"> </span><span class="hl-1">class</span><span class="hl-3"> </span><span class="hl-5">Statistics</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * La distancia recorrida semanalmente.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">_weekly_distance</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * La desviación estándar de la distancia recorrida semanalmente.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">_weekly_deviation</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * La distancia recorrida mensualmente.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">_monthly_distance</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * La desviación estándar de la distancia recorrida mensualmente.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">_monthly_deviation</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * La distancia recorrida anualmente.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">_annual_distance</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * La desviación estándar de la distancia recorrida anualmente.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">_annual_deviation</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Crea una nueva instancia de Statistics.</span><br/><span class="hl-0">   * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-2">weekly_distance</span><span class="hl-0"> La distancia recorrida semanalmente.</span><br/><span class="hl-0">   * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-2">weekly_deviation</span><span class="hl-0"> La desviación estándar de la distancia recorrida semanalmente.</span><br/><span class="hl-0">   * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-2">monthly_distance</span><span class="hl-0"> La distancia recorrida mensualmente.</span><br/><span class="hl-0">   * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-2">monthly_deviation</span><span class="hl-0"> La desviación estándar de la distancia recorrida mensualmente.</span><br/><span class="hl-0">   * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-2">annual_distance</span><span class="hl-0"> La distancia recorrida anualmente.</span><br/><span class="hl-0">   * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-2">annual_deviation</span><span class="hl-0"> La desviación estándar de la distancia recorrida anualmente.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-1">constructor</span><span class="hl-3">(</span><br/><span class="hl-3">    </span><span class="hl-2">weekly_distance</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">weekly_deviation</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">monthly_distance</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">monthly_deviation</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">annual_distance</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">annual_deviation</span><span class="hl-3">: </span><span class="hl-5">number</span><br/><span class="hl-3">  ) {</span><br/><span class="hl-3">    </span><span class="hl-1">this</span><span class="hl-3">.</span><span class="hl-2">_weekly_distance</span><span class="hl-3"> = </span><span class="hl-2">weekly_distance</span><span class="hl-3">;</span><br/><span class="hl-3">    </span><span class="hl-1">this</span><span class="hl-3">.</span><span class="hl-2">_weekly_deviation</span><span class="hl-3"> = </span><span class="hl-2">weekly_deviation</span><span class="hl-3">;</span><br/><span class="hl-3">    </span><span class="hl-1">this</span><span class="hl-3">.</span><span class="hl-2">_monthly_distance</span><span class="hl-3"> = </span><span class="hl-2">monthly_distance</span><span class="hl-3">;</span><br/><span class="hl-3">    </span><span class="hl-1">this</span><span class="hl-3">.</span><span class="hl-2">_monthly_deviation</span><span class="hl-3"> = </span><span class="hl-2">monthly_deviation</span><span class="hl-3">;</span><br/><span class="hl-3">    </span><span class="hl-1">this</span><span class="hl-3">.</span><span class="hl-2">_annual_distance</span><span class="hl-3"> = </span><span class="hl-2">annual_distance</span><span class="hl-3">;</span><br/><span class="hl-3">    </span><span class="hl-1">this</span><span class="hl-3">.</span><span class="hl-2">_annual_deviation</span><span class="hl-3"> = </span><span class="hl-2">annual_deviation</span><span class="hl-3">;</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">}</span><br/><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Interfaz que representa una fecha con día, mes y año.</span><br/><span class="hl-0"> */</span><br/><span class="hl-6">export</span><span class="hl-3"> </span><span class="hl-1">type</span><span class="hl-3"> </span><span class="hl-5">Date</span><span class="hl-3"> = {</span><br/><span class="hl-3">  </span><span class="hl-2">_day</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><span class="hl-3">  </span><span class="hl-2">_month</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><span class="hl-3">  </span><span class="hl-2">_year</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><span class="hl-3">};</span><br/><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Clase que representa un registro de historial de actividad.</span><br/><span class="hl-0"> */</span><br/><span class="hl-6">export</span><span class="hl-3"> </span><span class="hl-1">class</span><span class="hl-3"> </span><span class="hl-5">Record</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Identificador del registro.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">_id</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Fecha del registro.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">_date</span><span class="hl-3">: </span><span class="hl-5">Date</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Crea una instancia de la clase Record.</span><br/><span class="hl-0">   * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-2">id</span><span class="hl-0"> Identificador del registro.</span><br/><span class="hl-0">   * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-2">date</span><span class="hl-0"> Fecha del registro.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-1">constructor</span><span class="hl-3">(</span><span class="hl-2">id</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">, </span><span class="hl-2">date</span><span class="hl-3">: </span><span class="hl-5">Date</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-1">this</span><span class="hl-3">.</span><span class="hl-2">_id</span><span class="hl-3"> = </span><span class="hl-2">id</span><span class="hl-3">;</span><br/><span class="hl-3">    </span><span class="hl-1">this</span><span class="hl-3">.</span><span class="hl-2">_date</span><span class="hl-3"> = </span><span class="hl-2">date</span><span class="hl-3">;</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">}</span><br/><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Interfaz que representa un documento de usuario.</span><br/><span class="hl-0"> */</span><br/><span class="hl-6">export</span><span class="hl-3"> </span><span class="hl-1">interface</span><span class="hl-3"> </span><span class="hl-5">UserDocument</span><span class="hl-3"> </span><span class="hl-1">extends</span><span class="hl-3"> </span><span class="hl-5">Document</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Identificador del usuario.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">id</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Nombre del usuario.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">name</span><span class="hl-3">: </span><span class="hl-5">string</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Tipo de actividad del usuario.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">activity</span><span class="hl-3">: </span><span class="hl-5">Type</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Lista de identificadores de los amigos del usuario.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">friends</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">[];</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Lista de identificadores de los grupos a los que pertenece el usuario.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">groups</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">[];</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Estadísticas de actividad del usuario.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">statistics</span><span class="hl-3">: </span><span class="hl-5">Statistics</span><span class="hl-3">;</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Lista de identificadores de las pistas favoritas del usuario.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">favorite_tracks</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">[];</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Lista de identificadores de los desafíos en los que participa el usuario.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">challenges</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">[];</span><br/><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Registro de historial de actividad del usuario.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">history</span><span class="hl-3">: </span><span class="hl-5">Record</span><span class="hl-3">;</span><br/><span class="hl-3">}</span>
</code></pre>
<p>Este código define un conjunto de clases, interfaces y tipos que representan la estructura de datos de un usuario en una aplicación relacionada con la actividad física. La clase <code>Statistics</code> representa las estadísticas de actividad de un usuario, y la clase <code>Record</code> representa un registro de historial de actividad. La interfaz <code>UserDocument</code> representa un documento de usuario que se utiliza en la base de datos, y utiliza la enumeración <code>Type</code> importada desde el módulo <code>./track.js</code>. El código define también un tipo <code>Date</code> que representa una fecha con día, mes y año. En general, estos elementos se combinan para representar la información necesaria para un usuario en una aplicación de seguimiento de actividad física.</p>

<a href="#models" id="models" style="color: inherit; text-decoration: none;">
  <h3>Models</h3>
</a>
<p>El codigo del fichero challenge.ts es:</p>
<pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">Schema</span><span class="hl-3">, </span><span class="hl-2">model</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;mongoose&quot;</span><span class="hl-3">;</span><br/><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">ChallengeDocument</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;../interfaces/challenge.js&quot;</span><span class="hl-3">;</span><br/><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Esquema de Mongoose para el modelo de desafío.</span><br/><span class="hl-0"> * </span><span class="hl-1">@category</span><span class="hl-0"> Desafío</span><br/><span class="hl-0"> */</span><br/><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">ChallengeSchema</span><span class="hl-3"> = </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Schema</span><span class="hl-3">&lt;</span><span class="hl-5">ChallengeDocument</span><span class="hl-3">&gt;({</span><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Identificador único del desafío.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">id:</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">unique:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;El ID del desafío debe ser mayor que 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">      }</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  },</span><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Nombre del desafío.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">name:</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">String</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">trim:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">  },</span><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Lista de identificadores de las pistas asociadas al desafío.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">tracks:</span><span class="hl-3"> [</span><br/><span class="hl-3">    {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;El ID de la pista debe ser mayor que 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  ],</span><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Tipo de desafío.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">type:</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">String</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">trim:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">  },</span><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Longitud total de las pistas asociadas al desafío.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">long:</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;La longitud de la pista debe ser mayor que 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">      }</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  },</span><br/><span class="hl-3">  </span><span class="hl-0">/**</span><br/><span class="hl-0">   * Lista de identificadores de los usuarios que participan en el desafío.</span><br/><span class="hl-0">   */</span><br/><span class="hl-3">  </span><span class="hl-2">users:</span><span class="hl-3"> [</span><br/><span class="hl-3">    {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;El ID del usuario debe ser mayor que 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  ],</span><br/><span class="hl-3">});</span><br/><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Modelo de Mongoose para el desafío.</span><br/><span class="hl-0"> * </span><span class="hl-1">@category</span><span class="hl-0"> Desafío</span><br/><span class="hl-0"> */</span><br/><span class="hl-6">export</span><span class="hl-3"> </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">ChallengeModel</span><span class="hl-3"> = </span><span class="hl-4">model</span><span class="hl-3">&lt;</span><span class="hl-5">ChallengeDocument</span><span class="hl-3">&gt;(</span><br/><span class="hl-3">  </span><span class="hl-7">&quot;Challenge&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">  </span><span class="hl-2">ChallengeSchema</span><br/><span class="hl-3">);</span><br/><br/><br/><span class="hl-0">//example of a challenge</span><br/><span class="hl-0">// {</span><br/><span class="hl-0">//   &quot;id&quot;: 1,</span><br/><span class="hl-0">//   &quot;name&quot;: &quot;Challenge 1&quot;,</span><br/><span class="hl-0">//   &quot;tracks&quot;: [1, 2, 3],</span><br/><span class="hl-0">//   &quot;type&quot;: &quot;challenge&quot;,</span><br/><span class="hl-0">//   &quot;long&quot;: 100,</span><br/><span class="hl-0">//   &quot;users&quot;: [1, 2, 3]</span><br/><span class="hl-0">// }</span>
</code></pre>
<p>Este código es un ejemplo de cómo definir un esquema de datos y un modelo de Mongoose para un modelo de desafío en una aplicación Node.js con MongoDB. En resumen, el código hace lo siguiente:</p>
<ol>
<li>Importa las funciones <code>Schema</code> y <code>model</code> de Mongoose y la interfaz <code>ChallengeDocument</code> de otro archivo que define la estructura de los documentos del modelo de desafío.</li>
<li>Define un nuevo esquema de Mongoose para el modelo de desafío utilizando la función <code>Schema</code>. El esquema especifica los campos que componen el modelo de desafío y sus tipos de datos, opciones de validación, etc. En este caso, el modelo de desafío tiene seis campos: <code>id</code>, <code>name</code>, <code>tracks</code>, <code>type</code>, <code>long</code> y <code>users</code>.</li>
<li>Cada campo tiene una definición de tipo y opciones. Por ejemplo, el campo <code>id</code> tiene un tipo <code>Number</code> y es requerido y único. También tiene una función de validación personalizada que comprueba que el valor es mayor que 0. El campo <code>tracks</code> es una lista de números que también se valida para que cada valor sea mayor que 0. Los otros campos son similares.</li>
<li>Finalmente, el código exporta un modelo de Mongoose llamado <code>ChallengeModel</code> que utiliza el esquema <code>ChallengeSchema</code> y está etiquetado con el nombre &quot;Challenge&quot;.</li>
</ol>
<p>Este modelo se puede utilizar para realizar operaciones CRUD (crear, leer, actualizar y eliminar) en los documentos del modelo de desafío en la base de datos de MongoDB. El ejemplo de un desafío proporcionado al final del código muestra cómo se podrían ver los datos almacenados en un documento de desafío.</p>
<p>El codigo del fichero group.ts es:</p>
<pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">Schema</span><span class="hl-3">, </span><span class="hl-2">model</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;mongoose&quot;</span><span class="hl-3">;</span><br/><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">GroupDocument</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;../interfaces/group.js&quot;</span><span class="hl-3">;</span><br/><span class="hl-6">import</span><span class="hl-3"> </span><span class="hl-2">validator</span><span class="hl-3"> </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;validator&quot;</span><span class="hl-3">;</span><br/><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Esquema para un Grupo en la aplicación.</span><br/><span class="hl-0"> * </span><span class="hl-1">@typedef</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-5">GroupSchema</span><br/><span class="hl-0"> * </span><span class="hl-1">@property</span><span class="hl-0"> </span><span class="hl-5">{number}</span><span class="hl-0"> </span><span class="hl-2">id</span><span class="hl-0"> - ID del grupo.</span><br/><span class="hl-0"> * </span><span class="hl-1">@property</span><span class="hl-0"> </span><span class="hl-5">{string}</span><span class="hl-0"> </span><span class="hl-2">name</span><span class="hl-0"> - Nombre del grupo.</span><br/><span class="hl-0"> * </span><span class="hl-1">@property</span><span class="hl-0"> </span><span class="hl-5">{Array&lt;number&gt;}</span><span class="hl-0"> </span><span class="hl-2">members</span><span class="hl-0"> - IDs de los miembros del grupo.</span><br/><span class="hl-0"> * </span><span class="hl-1">@property</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">global_stadistics</span><span class="hl-0"> - Estadísticas globales del grupo.</span><br/><span class="hl-0"> * </span><span class="hl-1">@property</span><span class="hl-0"> </span><span class="hl-5">{number}</span><span class="hl-0"> </span><span class="hl-2">global_stadistics._weekly_distance</span><span class="hl-0"> - Distancia semanal total del grupo.</span><br/><span class="hl-0"> * </span><span class="hl-1">@property</span><span class="hl-0"> </span><span class="hl-5">{number}</span><span class="hl-0"> </span><span class="hl-2">global_stadistics._weekly_deviation</span><span class="hl-0"> - Desviación semanal total del grupo.</span><br/><span class="hl-0"> * </span><span class="hl-1">@property</span><span class="hl-0"> </span><span class="hl-5">{number}</span><span class="hl-0"> </span><span class="hl-2">global_stadistics._monthly_distance</span><span class="hl-0"> - Distancia mensual total del grupo.</span><br/><span class="hl-0"> * </span><span class="hl-1">@property</span><span class="hl-0"> </span><span class="hl-5">{number}</span><span class="hl-0"> </span><span class="hl-2">global_stadistics._monthly_deviation</span><span class="hl-0"> - Desviación mensual total del grupo.</span><br/><span class="hl-0"> * </span><span class="hl-1">@property</span><span class="hl-0"> </span><span class="hl-5">{number}</span><span class="hl-0"> </span><span class="hl-2">global_stadistics._annual_distance</span><span class="hl-0"> - Distancia anual total del grupo.</span><br/><span class="hl-0"> * </span><span class="hl-1">@property</span><span class="hl-0"> </span><span class="hl-5">{number}</span><span class="hl-0"> </span><span class="hl-2">global_stadistics._annual_deviation</span><span class="hl-0"> - Desviación anual total del grupo.</span><br/><span class="hl-0"> * </span><span class="hl-1">@property</span><span class="hl-0"> </span><span class="hl-5">{Array&lt;number&gt;}</span><span class="hl-0"> </span><span class="hl-2">ranking</span><span class="hl-0"> - IDs de los usuarios en el ranking del grupo.</span><br/><span class="hl-0"> * </span><span class="hl-1">@property</span><span class="hl-0"> </span><span class="hl-5">{Array&lt;number&gt;}</span><span class="hl-0"> </span><span class="hl-2">favorite_tracks</span><span class="hl-0"> - IDs de las pistas favoritas del grupo.</span><br/><span class="hl-0"> * </span><span class="hl-1">@property</span><span class="hl-0"> </span><span class="hl-5">{Array&lt;Object&gt;}</span><span class="hl-0"> </span><span class="hl-2">group_history</span><span class="hl-0"> - Historial de pistas del grupo.</span><br/><span class="hl-0"> * </span><span class="hl-1">@property</span><span class="hl-0"> </span><span class="hl-5">{number}</span><span class="hl-0"> </span><span class="hl-2">group_history._id</span><span class="hl-0"> - ID de la pista.</span><br/><span class="hl-0"> * </span><span class="hl-1">@property</span><span class="hl-0"> </span><span class="hl-5">{string}</span><span class="hl-0"> </span><span class="hl-2">group_history._date</span><span class="hl-0"> - Fecha de la pista en formato &quot;YYYY-MM-DD&quot;.</span><br/><span class="hl-0"> */</span><br/><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">GroupSchema</span><span class="hl-3"> = </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Schema</span><span class="hl-3">&lt;</span><span class="hl-5">GroupDocument</span><span class="hl-3">&gt;({</span><br/><span class="hl-3">  </span><span class="hl-2">id:</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">unique:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;El ID del grupo debe ser mayor que 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">      }</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  },</span><br/><span class="hl-3">  </span><span class="hl-2">name:</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">String</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">trim:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">  },</span><br/><span class="hl-3">  </span><span class="hl-2">members:</span><span class="hl-3"> [</span><br/><span class="hl-3">    {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;El ID del usuario debe ser mayor que 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  ],</span><br/><span class="hl-3">  </span><span class="hl-2">global_stadistics:</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-2">_weekly_distance:</span><span class="hl-3"> {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;La distancia debe ser mayor que 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">    </span><span class="hl-2">_weekly_deviation:</span><span class="hl-3"> {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;La desviación debe ser mayor que 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">    </span><span class="hl-2">_monthly_distance:</span><span class="hl-3"> {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;La distancia debe ser mayor que 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">    </span><span class="hl-2">_monthly_deviation:</span><span class="hl-3"> {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;La desviación debe ser mayor que 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">    </span><span class="hl-2">_annual_distance:</span><span class="hl-3"> {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Distance must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">    </span><span class="hl-2">_annual_deviation:</span><span class="hl-3"> {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Deviation must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  },</span><br/><span class="hl-3">  </span><span class="hl-2">ranking:</span><span class="hl-3"> [</span><br/><span class="hl-3">    {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;User ID must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  ],</span><br/><span class="hl-3">  </span><span class="hl-2">favorite_tracks:</span><span class="hl-3"> [</span><br/><span class="hl-3">    {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Track ID must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  ],</span><br/><span class="hl-3">  </span><span class="hl-2">group_history:</span><span class="hl-3"> [</span><br/><span class="hl-3">    {</span><br/><span class="hl-3">      </span><span class="hl-2">_id:</span><span class="hl-3"> {</span><br/><span class="hl-3">        </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">        </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">        </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">            </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Track ID must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">          }</span><br/><span class="hl-3">        },</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">      </span><span class="hl-2">_date:</span><span class="hl-3"> {</span><br/><span class="hl-3">        </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">String</span><span class="hl-3">,</span><br/><span class="hl-3">        </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">        </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">string</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">if</span><span class="hl-3"> (!</span><span class="hl-2">validator</span><span class="hl-3">.</span><span class="hl-2">default</span><span class="hl-3">.</span><span class="hl-4">isDate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">)) {</span><br/><span class="hl-3">            </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Date is invalid&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">          }</span><br/><span class="hl-3">        },</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  ],</span><br/><span class="hl-3">});</span><br/><br/><span class="hl-6">export</span><span class="hl-3"> </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">GroupModel</span><span class="hl-3"> = </span><span class="hl-4">model</span><span class="hl-3">&lt;</span><span class="hl-5">GroupDocument</span><span class="hl-3">&gt;(</span><span class="hl-7">&quot;Group&quot;</span><span class="hl-3">, </span><span class="hl-2">GroupSchema</span><span class="hl-3">);</span><br/><br/><span class="hl-0">//example of a group</span><br/><span class="hl-0">// {</span><br/><span class="hl-0">//   &quot;id&quot;: 1,</span><br/><span class="hl-0">//   &quot;name&quot;: &quot;Grupo 1&quot;,</span><br/><span class="hl-0">//   &quot;members&quot;: [1, 2, 3, 4, 5],</span><br/><span class="hl-0">//   &quot;global_stadistics&quot;: {</span><br/><span class="hl-0">//     &quot;_weekly_distance&quot;: 123,</span><br/><span class="hl-0">//     &quot;_weekly_deviation&quot;: 123,</span><br/><span class="hl-0">//     &quot;_monthly_distance&quot;: 123,</span><br/><span class="hl-0">//     &quot;_monthly_deviation&quot;: 123,</span><br/><span class="hl-0">//     &quot;_annual_distance&quot;: 123,</span><br/><span class="hl-0">//     &quot;_annual_deviation&quot;: 123</span><br/><span class="hl-0">//   },</span><br/><span class="hl-0">//   &quot;ranking&quot;: [1, 2, 3, 4, 5],</span><br/><span class="hl-0">//   &quot;favorite_tracks&quot;: [1, 2, 3, 4, 5],</span><br/><span class="hl-0">//   &quot;group_history&quot;: [</span><br/><span class="hl-0">//     {</span><br/><span class="hl-0">//       &quot;_id&quot;: 1,</span><br/><span class="hl-0">//       &quot;_date&quot;: &quot;2021-10-10&quot;</span><br/><span class="hl-0">//     },</span><br/><span class="hl-0">//     {</span><br/><span class="hl-0">//       &quot;_id&quot;: 2,</span><br/><span class="hl-0">//       &quot;_date&quot;: &quot;2021-10-10&quot;</span><br/><span class="hl-0">//     },</span><br/><span class="hl-0">//   ]</span><br/><span class="hl-0">// }</span>
</code></pre>
<p>Este código es un modelo de mongoose para un esquema de un grupo en una aplicación. El código importa <code>Schema</code> y <code>model</code> de mongoose y <code>validator</code> de una librería externa. El modelo define los campos que debe tener un grupo, como su <code>id</code>, <code>name</code>, <code>members</code>, <code>global_stadistics</code>, <code>ranking</code>, <code>favorite_tracks</code>, y <code>group_history</code>. La mayoría de los campos son arreglos o objetos que contienen subcampos, y algunos campos tienen validaciones para asegurarse de que los valores ingresados cumplan con ciertos requisitos, como ser mayores que cero y tener un formato de fecha válido. Además, el modelo utiliza el tipo de documento <code>GroupDocument</code>, que está definido en otro archivo en una interfaz. El modelo finalmente se exporta como <code>GroupModel</code>. El ejemplo de un grupo al final del archivo muestra cómo se vería un objeto que se ajusta al esquema de este modelo.</p>
<p>El codigo del fichero track.ts es:</p>
<pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">Schema</span><span class="hl-3">, </span><span class="hl-2">model</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;mongoose&quot;</span><span class="hl-3">;</span><br/><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">TrackDocument</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;../interfaces/track.js&quot;</span><span class="hl-3">;</span><br/><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Esquema de Mongoose para una pista</span><br/><span class="hl-0"> */</span><br/><br/><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">TrackSchema</span><span class="hl-3"> = </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Schema</span><span class="hl-3">&lt;</span><span class="hl-5">TrackDocument</span><span class="hl-3">&gt;({</span><br/><span class="hl-3">  </span><span class="hl-2">id:</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">unique:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Track ID must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">      }</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  },</span><br/><span class="hl-3">  </span><span class="hl-2">name:</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">String</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">trim:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">  },</span><br/><span class="hl-3">  </span><span class="hl-2">start:</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-2">lat:</span><span class="hl-3"> {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Latitude must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">    </span><span class="hl-2">long:</span><span class="hl-3"> {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Length must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">    </span><span class="hl-2">alt:</span><span class="hl-3"> {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Altitude must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  },</span><br/><span class="hl-3">  </span><span class="hl-2">end:</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-2">lat:</span><span class="hl-3"> {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Latitude must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">    </span><span class="hl-2">long:</span><span class="hl-3"> {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Length must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">    </span><span class="hl-2">alt:</span><span class="hl-3"> {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Altitude must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  },</span><br/><span class="hl-3">  </span><span class="hl-2">long:</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Track length must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">      }</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  },</span><br/><span class="hl-3">  </span><span class="hl-2">grade:</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Grade of desviation must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">      }</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  },</span><br/><span class="hl-3">  </span><span class="hl-2">users:</span><span class="hl-3"> [</span><br/><span class="hl-3">    {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;User ID must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  ],</span><br/><span class="hl-3">  </span><span class="hl-2">type:</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">String</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">trim:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">  },</span><br/><span class="hl-3">  </span><span class="hl-2">puntuation:</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3"> || </span><span class="hl-2">value</span><span class="hl-3"> &gt; </span><span class="hl-9">5</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Puntuation must be a number between 0 and 5&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">      }</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  },</span><br/><span class="hl-3">});</span><br/><br/><span class="hl-6">export</span><span class="hl-3"> </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">TrackModel</span><span class="hl-3"> = </span><span class="hl-4">model</span><span class="hl-3">&lt;</span><span class="hl-5">TrackDocument</span><span class="hl-3">&gt;(</span><span class="hl-7">&quot;Track&quot;</span><span class="hl-3">, </span><span class="hl-2">TrackSchema</span><span class="hl-3">);</span><br/><br/><span class="hl-0">// example of a track</span><br/><span class="hl-0">// {</span><br/><span class="hl-0">//   &quot;id&quot;: 1,</span><br/><span class="hl-0">//   &quot;name&quot;: &quot;Track 1&quot;,</span><br/><span class="hl-0">//   &quot;start&quot;: {</span><br/><span class="hl-0">//     &quot;lat&quot;: 28.123,</span><br/><span class="hl-0">//     &quot;long&quot;: 16.123,</span><br/><span class="hl-0">//     &quot;alt&quot;: 123</span><br/><span class="hl-0">//   },</span><br/><span class="hl-0">//   &quot;end&quot;: {</span><br/><span class="hl-0">//     &quot;lat&quot;: 28.123,</span><br/><span class="hl-0">//     &quot;long&quot;: 16.123,</span><br/><span class="hl-0">//     &quot;alt&quot;: 123</span><br/><span class="hl-0">//   },</span><br/><span class="hl-0">//   &quot;long&quot;: 123,</span><br/><span class="hl-0">//   &quot;grade&quot;: 123,</span><br/><span class="hl-0">//   &quot;users&quot;: [1, 2, 3],</span><br/><span class="hl-0">//   &quot;type&quot;: &quot;running&quot;,</span><br/><span class="hl-0">//   &quot;puntuation&quot;: 4</span><br/><span class="hl-0">// }</span>
</code></pre>
<p>Este código es una definición de un esquema de Mongoose para una pista de carrera o senderismo, utilizando TypeScript. Mongoose es una biblioteca de modelado de objetos de MongoDB para Node.js y permite definir modelos para las colecciones de MongoDB. </p>
<p>En primer lugar, se importan las clases <code>Schema</code> y <code>model</code> de Mongoose y la interfaz <code>TrackDocument</code>. Luego, se define un objeto <code>TrackSchema</code> que contiene los campos de una pista, tales como <code>id</code>, <code>name</code>, <code>start</code>, <code>end</code>, <code>long</code>, <code>grade</code>, <code>users</code>, <code>type</code> y <code>puntuation</code>. </p>
<p>Cada campo tiene un tipo de dato específico (como <code>Number</code> o <code>String</code>) y, en algunos casos, también se definen opciones adicionales (como <code>required: true</code> o <code>unique: true</code>). Además, algunos campos también tienen validaciones personalizadas, como asegurarse de que los valores numéricos sean mayores que cero o que la puntación esté entre 0 y 5.</p>
<p>Finalmente, se exporta el modelo <code>TrackModel</code>, que se puede utilizar para realizar operaciones CRUD (Crear, Leer, Actualizar, Eliminar) en la colección de pistas en MongoDB. El ejemplo al final del código es una instancia de un objeto de pista con valores de ejemplo para cada campo.</p>
<p>El codigo del fichero user.ts es:</p>
<pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">Schema</span><span class="hl-3">, </span><span class="hl-2">model</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;mongoose&quot;</span><span class="hl-3">;</span><br/><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">UserDocument</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;../interfaces/user.js&quot;</span><span class="hl-3">;</span><br/><span class="hl-6">import</span><span class="hl-3"> </span><span class="hl-2">validator</span><span class="hl-3"> </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;validator&quot;</span><span class="hl-3">;</span><br/><br/><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">UserSchema</span><span class="hl-3"> = </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Schema</span><span class="hl-3">&lt;</span><span class="hl-5">UserDocument</span><span class="hl-3">&gt;({</span><br/><span class="hl-3">  </span><span class="hl-2">id:</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">unique:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;User ID must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">      }</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  },</span><br/><span class="hl-3">  </span><span class="hl-2">name:</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">String</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">trim:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">  },</span><br/><span class="hl-3">  </span><span class="hl-2">activity:</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">String</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-2">trim:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">  },</span><br/><span class="hl-3">  </span><span class="hl-2">friends:</span><span class="hl-3"> [</span><br/><span class="hl-3">    {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;User ID must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  ],</span><br/><span class="hl-3">  </span><span class="hl-2">groups:</span><span class="hl-3"> [</span><br/><span class="hl-3">    {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Group ID must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  ],</span><br/><span class="hl-3">  </span><span class="hl-2">statistics:</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-2">_weekly_distance:</span><span class="hl-3"> {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Distance must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">    </span><span class="hl-2">_weekly_deviation:</span><span class="hl-3"> {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Deviation must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">    </span><span class="hl-2">_monthly_distance:</span><span class="hl-3"> {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Distance must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">    </span><span class="hl-2">_monthly_deviation:</span><span class="hl-3"> {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Deviation must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">    </span><span class="hl-2">_annual_distance:</span><span class="hl-3"> {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Distance must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">    </span><span class="hl-2">_annual_deviation:</span><span class="hl-3"> {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Deviation must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  },</span><br/><span class="hl-3">  </span><span class="hl-2">favorite_tracks:</span><span class="hl-3"> [</span><br/><span class="hl-3">    {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Track ID must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  ],</span><br/><span class="hl-3">  </span><span class="hl-2">challenges:</span><span class="hl-3"> [</span><br/><span class="hl-3">    {</span><br/><span class="hl-3">      </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">        </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Challenge ID must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">        }</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  ],</span><br/><span class="hl-3">  </span><span class="hl-2">history:</span><span class="hl-3"> [</span><br/><span class="hl-3">    {</span><br/><span class="hl-3">      </span><span class="hl-2">_id:</span><span class="hl-3"> {</span><br/><span class="hl-3">        </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">Number</span><span class="hl-3">,</span><br/><span class="hl-3">        </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">        </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">number</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">value</span><span class="hl-3"> &lt; </span><span class="hl-9">0</span><span class="hl-3">) {</span><br/><span class="hl-3">            </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Track ID must be greater than 0&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">          }</span><br/><span class="hl-3">        },</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">      </span><span class="hl-2">_date:</span><span class="hl-3"> {</span><br/><span class="hl-3">        </span><span class="hl-2">type:</span><span class="hl-3"> </span><span class="hl-2">String</span><span class="hl-3">,</span><br/><span class="hl-3">        </span><span class="hl-2">required:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">        </span><span class="hl-4">validate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">: </span><span class="hl-5">string</span><span class="hl-3">) {</span><br/><span class="hl-3">          </span><span class="hl-6">if</span><span class="hl-3"> (!</span><span class="hl-2">validator</span><span class="hl-3">.</span><span class="hl-2">default</span><span class="hl-3">.</span><span class="hl-4">isDate</span><span class="hl-3">(</span><span class="hl-2">value</span><span class="hl-3">)) {</span><br/><span class="hl-3">            </span><span class="hl-6">throw</span><span class="hl-3"> </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">Error</span><span class="hl-3">(</span><span class="hl-7">&quot;Date is invalid&quot;</span><span class="hl-3">);</span><br/><span class="hl-3">          }</span><br/><span class="hl-3">        },</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">    },</span><br/><span class="hl-3">  ],</span><br/><span class="hl-3">});</span><br/><br/><span class="hl-6">export</span><span class="hl-3"> </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">UserModel</span><span class="hl-3"> = </span><span class="hl-4">model</span><span class="hl-3">&lt;</span><span class="hl-5">UserDocument</span><span class="hl-3">&gt;(</span><span class="hl-7">&quot;User&quot;</span><span class="hl-3">, </span><span class="hl-2">UserSchema</span><span class="hl-3">);</span><br/><br/><span class="hl-0">//example of a user</span><br/><span class="hl-0">// {</span><br/><span class="hl-0">//   &quot;id&quot;: 1,</span><br/><span class="hl-0">//   &quot;name&quot;: &quot;John Doe&quot;,</span><br/><span class="hl-0">//   &quot;activity&quot;: &quot;running&quot;,</span><br/><span class="hl-0">//   &quot;friends&quot;: [2, 3, 4],</span><br/><span class="hl-0">//   &quot;groups&quot;: [1, 2],</span><br/><span class="hl-0">//   &quot;statistics&quot;: {</span><br/><span class="hl-0">//     &quot;weekly_distance&quot;: 100,</span><br/><span class="hl-0">//     &quot;weekly_deviation&quot;: 10,</span><br/><span class="hl-0">//     &quot;monthly_distance&quot;: 200,</span><br/><span class="hl-0">//     &quot;monthly_deviation&quot;: 20,</span><br/><span class="hl-0">//     &quot;annual_distance&quot;: 300,</span><br/><span class="hl-0">//     &quot;annual_deviation&quot;: 30</span><br/><span class="hl-0">//   },</span><br/><span class="hl-0">//  &quot;favorite_tracks&quot;: [1, 2, 3],</span><br/><span class="hl-0">//  &quot;challenges&quot;: [1, 2, 3],</span><br/><span class="hl-0">//  &quot;history&quot;: [</span><br/><span class="hl-0">//    {</span><br/><span class="hl-0">//      &quot;id&quot;: 1,</span><br/><span class="hl-0">//      &quot;date&quot;: &quot;2021-10-10&quot;</span><br/><span class="hl-0">//   },</span><br/><span class="hl-0">//   {</span><br/><span class="hl-0">//      &quot;id&quot;: 2,</span><br/><span class="hl-0">//      &quot;date&quot;: &quot;2021-10-11&quot;</span><br/><span class="hl-0">//   }</span><br/><span class="hl-0">//  ]</span><br/><span class="hl-0">// }</span>
</code></pre>
<p>Este código es un modelo de mongoose que define un esquema para los usuarios de una aplicación. Mongoose es una biblioteca de JavaScript que se utiliza para interactuar con bases de datos MongoDB. </p>
<p>El código importa dos objetos de mongoose: <code>Schema</code> y <code>model</code>. <code>Schema</code> se utiliza para definir la estructura de la colección de MongoDB y <code>model</code> se utiliza para crear un modelo de esta estructura.</p>
<p>El objeto <code>UserSchema</code> define la estructura del documento de usuario que se almacenará en MongoDB. Tiene un campo <code>id</code> de tipo numérico, <code>name</code> y <code>activity</code> de tipo cadena de texto, <code>friends</code> y <code>groups</code> que son matrices de identificadores de usuarios y grupos respectivamente, <code>statistics</code> que es un objeto con campos numéricos que almacenan la distancia y la desviación de un usuario en diferentes periodos de tiempo, <code>favorite_tracks</code> y <code>challenges</code> que son matrices de identificadores de pistas y desafíos respectivamente, y <code>history</code> que es una matriz de objetos que contienen el identificador de una pista y la fecha en que el usuario la completó.</p>
<p>Cada campo tiene un tipo de dato y puede tener validaciones adicionales, como <code>required</code>, <code>unique</code>, <code>trim</code> y <code>validate</code>. Las validaciones se utilizan para asegurarse de que los datos cumplen ciertas condiciones, por ejemplo, que los identificadores sean mayores que cero y que las fechas sean válidas.</p>
<p>El objeto <code>UserModel</code> es un modelo de mongoose que se crea a partir del esquema <code>UserSchema</code>. Se utiliza para realizar operaciones de lectura y escritura en la colección de usuarios de MongoDB. </p>
<p>Finalmente, se proporciona un ejemplo de cómo se vería un documento de usuario almacenado en la base de datos.</p>

<a href="#routers" id="routers" style="color: inherit; text-decoration: none;">
  <h3>routers</h3>
</a>
<p>El codigo del fichero challenge.ts es:</p>
<pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-3"> </span><span class="hl-2">express</span><span class="hl-3"> </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;express&quot;</span><span class="hl-3">;</span><br/><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">ChallengeModel</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;../models/challenge.js&quot;</span><span class="hl-3">;</span><br/><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Express Router for challenges</span><br/><span class="hl-0"> */</span><br/><span class="hl-6">export</span><span class="hl-3"> </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">challengeRouter</span><span class="hl-3"> = </span><span class="hl-2">express</span><span class="hl-3">.</span><span class="hl-4">Router</span><span class="hl-3">();</span><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Create a new challenge</span><br/><span class="hl-0"> * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-2">req</span><span class="hl-0"> - Express request object</span><br/><span class="hl-0"> * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-2">res</span><span class="hl-0"> - Express response object</span><br/><span class="hl-0"> * </span><span class="hl-1">@returns</span><span class="hl-0"> The created challenge</span><br/><span class="hl-0"> */</span><br/><span class="hl-2">challengeRouter</span><span class="hl-3">.</span><span class="hl-4">post</span><span class="hl-3">(</span><span class="hl-7">&quot;/challenges&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">challenge</span><span class="hl-3"> = </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">ChallengeModel</span><span class="hl-3">(</span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">body</span><span class="hl-3">);</span><br/><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">challenge</span><span class="hl-3">.</span><span class="hl-4">save</span><span class="hl-3">();</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">201</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">challenge</span><span class="hl-3">);</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Get challenges that match a filter</span><br/><span class="hl-0"> * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-2">req</span><span class="hl-0"> - Express request object</span><br/><span class="hl-0"> * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-2">res</span><span class="hl-0"> - Express response object</span><br/><span class="hl-0"> * </span><span class="hl-1">@returns</span><span class="hl-0"> Challenges that match the filter</span><br/><span class="hl-0"> */</span><br/><span class="hl-2">challengeRouter</span><span class="hl-3">.</span><span class="hl-4">get</span><span class="hl-3">(</span><span class="hl-7">&quot;/challenges&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">filter</span><span class="hl-3"> = </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3"> ? { </span><span class="hl-2">name:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3">.</span><span class="hl-4">toString</span><span class="hl-3">() } : {};</span><br/><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">challenges</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">ChallengeModel</span><span class="hl-3">.</span><span class="hl-4">findOne</span><span class="hl-3">(</span><span class="hl-2">filter</span><span class="hl-3">);</span><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">challenges</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">challenges</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Get a challenge by ID</span><br/><span class="hl-0"> * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-2">req</span><span class="hl-0"> - Express request object</span><br/><span class="hl-0"> * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-2">res</span><span class="hl-0"> - Express response object</span><br/><span class="hl-0"> * </span><span class="hl-1">@returns</span><span class="hl-0"> The challenge that matches the ID</span><br/><span class="hl-0"> */</span><br/><span class="hl-2">challengeRouter</span><span class="hl-3">.</span><span class="hl-4">get</span><span class="hl-3">(</span><span class="hl-7">&quot;/challenges/:id&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">challenges</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">ChallengeModel</span><span class="hl-3">.</span><span class="hl-4">findOne</span><span class="hl-3">({</span><br/><span class="hl-3">      </span><span class="hl-2">id:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">params</span><span class="hl-3">.</span><span class="hl-2">id</span><span class="hl-3">,</span><br/><span class="hl-3">    });</span><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">challenges</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">challenges</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Update a challenge by name</span><br/><span class="hl-0"> * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-2">req</span><span class="hl-0"> - Express request object</span><br/><span class="hl-0"> * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-2">res</span><span class="hl-0"> - Express response object</span><br/><span class="hl-0"> * </span><span class="hl-1">@returns</span><span class="hl-0"> The updated challenge</span><br/><span class="hl-0"> */</span><br/><span class="hl-2">challengeRouter</span><span class="hl-3">.</span><span class="hl-4">patch</span><span class="hl-3">(</span><span class="hl-7">&quot;/challenges&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">if</span><span class="hl-3"> (!</span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">400</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">({ </span><span class="hl-2">error:</span><span class="hl-3"> </span><span class="hl-7">&quot;No name provided&quot;</span><span class="hl-3"> });</span><br/><span class="hl-3">  }</span><br/><br/><span class="hl-3">  </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">allowedUpdates</span><span class="hl-3"> = </span><span class="hl-2">Object</span><span class="hl-3">.</span><span class="hl-4">keys</span><span class="hl-3">(</span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">body</span><span class="hl-3">);</span><br/><span class="hl-3">  </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">actualUpdates</span><span class="hl-3"> = [</span><span class="hl-7">&quot;id&quot;</span><span class="hl-3">, </span><span class="hl-7">&quot;name&quot;</span><span class="hl-3">, </span><span class="hl-7">&quot;tracks&quot;</span><span class="hl-3">, </span><span class="hl-7">&quot;type&quot;</span><span class="hl-3">, </span><span class="hl-7">&quot;long&quot;</span><span class="hl-3">, </span><span class="hl-7">&quot;users&quot;</span><span class="hl-3">];</span><br/><br/><span class="hl-3">  </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">isValidOperation</span><span class="hl-3"> = </span><span class="hl-2">actualUpdates</span><span class="hl-3">.</span><span class="hl-4">every</span><span class="hl-3">((</span><span class="hl-2">update</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-2">allowedUpdates</span><span class="hl-3">.</span><span class="hl-4">includes</span><span class="hl-3">(</span><span class="hl-2">update</span><span class="hl-3">);</span><br/><span class="hl-3">  });</span><br/><br/><span class="hl-3">  </span><span class="hl-6">if</span><span class="hl-3"> (!</span><span class="hl-2">isValidOperation</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">400</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">({ </span><span class="hl-2">error:</span><span class="hl-3"> </span><span class="hl-7">&quot;Invalid updates&quot;</span><span class="hl-3"> });</span><br/><span class="hl-3">  }</span><br/><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">challenge</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">ChallengeModel</span><span class="hl-3">.</span><span class="hl-4">findOneAndUpdate</span><span class="hl-3">(</span><br/><span class="hl-3">      {</span><br/><span class="hl-3">        </span><span class="hl-2">name:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3">.</span><span class="hl-4">toString</span><span class="hl-3">(),</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">      </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">body</span><span class="hl-3">,</span><br/><span class="hl-3">      {</span><br/><span class="hl-3">        </span><span class="hl-2">new:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">        </span><span class="hl-2">runValidators:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      }</span><br/><span class="hl-3">    );</span><br/><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">challenge</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">challenge</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Update a challenge by ID</span><br/><span class="hl-0"> * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-2">req</span><span class="hl-0"> - Express request object</span><br/><span class="hl-0"> * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-2">res</span><span class="hl-0"> - Express response object</span><br/><span class="hl-0"> * </span><span class="hl-1">@returns</span><span class="hl-0"> The updated challenge</span><br/><span class="hl-0"> */</span><br/><span class="hl-2">challengeRouter</span><span class="hl-3">.</span><span class="hl-4">patch</span><span class="hl-3">(</span><span class="hl-7">&quot;/challenges/:id&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">challenge</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">ChallengeModel</span><span class="hl-3">.</span><span class="hl-4">findOneAndUpdate</span><span class="hl-3">(</span><br/><span class="hl-3">      {</span><br/><span class="hl-3">        </span><span class="hl-2">id:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">params</span><span class="hl-3">.</span><span class="hl-2">id</span><span class="hl-3">,</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">      </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">body</span><span class="hl-3">,</span><br/><span class="hl-3">      {</span><br/><span class="hl-3">        </span><span class="hl-2">new:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">        </span><span class="hl-2">runValidators:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      }</span><br/><span class="hl-3">    );</span><br/><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">challenge</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">challenge</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Maneja las solicitudes para eliminar un desafío por su nombre.</span><br/><span class="hl-1">@function</span><br/><span class="hl-1">@async</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">req</span><span class="hl-0"> - Objeto de solicitud Express.</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">res</span><span class="hl-0"> - Objeto de respuesta Express.</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> Objeto del desafío eliminado.</span><br/><span class="hl-1">@throws</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> Error de servidor interno.</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">challengeRouter</span><span class="hl-3">.</span><span class="hl-4">delete</span><span class="hl-3">(</span><span class="hl-7">&quot;/challenges&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">if</span><span class="hl-3"> (!</span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">400</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">challenge</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">ChallengeModel</span><span class="hl-3">.</span><span class="hl-4">findOneAndDelete</span><span class="hl-3">({</span><br/><span class="hl-3">      </span><span class="hl-2">name:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3">,</span><br/><span class="hl-3">    });</span><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">challenge</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">challenge</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Maneja las solicitudes para eliminar un desafío por su ID.</span><br/><span class="hl-1">@function</span><br/><span class="hl-1">@async</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">req</span><span class="hl-0"> - Objeto de solicitud Express.</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">res</span><span class="hl-0"> - Objeto de respuesta Express.</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> Objeto del desafío eliminado.</span><br/><span class="hl-1">@throws</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> Error de servidor interno.</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">challengeRouter</span><span class="hl-3">.</span><span class="hl-4">delete</span><span class="hl-3">(</span><span class="hl-7">&quot;/challenges/:id&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">challenge</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">ChallengeModel</span><span class="hl-3">.</span><span class="hl-4">findOneAndDelete</span><span class="hl-3">({</span><br/><span class="hl-3">      </span><span class="hl-2">id:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">params</span><span class="hl-3">.</span><span class="hl-2">id</span><span class="hl-3">,</span><br/><span class="hl-3">    });</span><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">challenge</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">challenge</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span>
</code></pre>
<p>Este código crea un enrutador de Express para manejar solicitudes relacionadas con los desafíos. El enrutador se exporta como un objeto llamado <code>challengeRouter</code>.</p>
<p>El código define varias rutas HTTP para manejar solicitudes de creación, lectura, actualización y eliminación de desafíos. Cada ruta se define usando una función de enrutamiento correspondiente de Express (por ejemplo, <code>challengeRouter.post</code> para la creación de desafíos) y especifica una URL de ruta (por ejemplo, <code>&quot;/challenges&quot;</code> para la ruta de creación).</p>
<p>La ruta de creación de desafíos (<code>challengeRouter.post</code>) espera una solicitud HTTP POST que contiene datos de desafío en el cuerpo de la solicitud. Luego crea un nuevo objeto de modelo de desafío utilizando los datos proporcionados y lo guarda en la base de datos. Si la operación es exitosa, devuelve el objeto de desafío recién creado en una respuesta HTTP con un código de estado 201 (creado).</p>
<p>La ruta de lectura de desafíos (<code>challengeRouter.get</code>) se puede invocar de dos maneras diferentes. Si se llama sin un parámetro de consulta, devuelve una lista de todos los desafíos en la base de datos. Si se llama con un parámetro de consulta llamado &quot;name&quot;, devuelve una lista de desafíos que coinciden con el valor de ese parámetro. Si se encuentra uno o más desafíos, los devuelve en una respuesta HTTP con un código de estado 200 (éxito). Si no se encuentra ningún desafío, devuelve una respuesta HTTP con un código de estado 404 (no encontrado).</p>
<p>Las rutas de actualización de desafíos (<code>challengeRouter.patch</code>) se pueden invocar de dos maneras diferentes. La primera ruta espera un parámetro de consulta &quot;name&quot; y los datos de desafío actualizados en el cuerpo de la solicitud. Busca un desafío con el nombre dado, actualiza los campos correspondientes con los datos proporcionados y devuelve el objeto de desafío actualizado en una respuesta HTTP con un código de estado 200 (éxito). Si no se encuentra un desafío con el nombre dado, devuelve una respuesta HTTP con un código de estado 404 (no encontrado). La segunda ruta espera un parámetro de ruta &quot;id&quot; en lugar de un parámetro de consulta, y actualiza un desafío con el ID dado de manera similar.</p>
<p>Las rutas de eliminación de desafíos (<code>challengeRouter.delete</code>) se pueden invocar de manera similar a las rutas de actualización. La primera ruta espera un parámetro de consulta &quot;name&quot; y elimina un desafío con el nombre dado de la base de datos. Si se encuentra y elimina un desafío, devuelve el objeto de desafío eliminado en una respuesta HTTP con un código de estado 200 (éxito). Si no se encuentra un desafío con el nombre dado, devuelve una respuesta HTTP con un código de estado 404 (no encontrado). La segunda ruta espera un parámetro de ruta &quot;id&quot; en lugar de un parámetro de consulta, y elimina un desafío con el ID dado de manera similar.</p>
<p>El codigo del fichero default.ts es:</p>
<pre><code class="language-ts"><span class="hl-0">/** </span><br/><span class="hl-0"> * </span><span class="hl-1">@fileoverview</span><span class="hl-0"> Define el enrutador por defecto que maneja todas las peticiones no encontradas </span><br/><span class="hl-0"> * </span><span class="hl-1">@module</span><span class="hl-0"> </span><span class="hl-5">DefaultRouter</span><br/><span class="hl-0"> */</span><br/><br/><span class="hl-6">import</span><span class="hl-3"> </span><span class="hl-2">express</span><span class="hl-3">, { </span><span class="hl-2">Request</span><span class="hl-3">, </span><span class="hl-2">Response</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;express&quot;</span><span class="hl-3">;</span><br/><br/><span class="hl-0">/** Define el enrutador por defecto */</span><br/><span class="hl-6">export</span><span class="hl-3"> </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">defaultRouter</span><span class="hl-3"> = </span><span class="hl-2">express</span><span class="hl-3">.</span><span class="hl-4">Router</span><span class="hl-3">();</span><br/><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * Maneja todas las peticiones no encontradas y devuelve un estado 501</span><br/><span class="hl-0"> * </span><span class="hl-1">@name</span><span class="hl-0"> </span><span class="hl-5">all/*</span><br/><span class="hl-0"> * </span><span class="hl-1">@function</span><br/><span class="hl-0"> * </span><span class="hl-1">@memberof</span><span class="hl-0"> </span><span class="hl-5">module:DefaultRouter</span><br/><span class="hl-0"> * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Request}</span><span class="hl-0"> </span><span class="hl-2">req</span><span class="hl-0"> - Objeto de solicitud de Express</span><br/><span class="hl-0"> * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Response}</span><span class="hl-0"> </span><span class="hl-2">res</span><span class="hl-0"> - Objeto de respuesta de Express</span><br/><span class="hl-0"> */</span><br/><span class="hl-2">defaultRouter</span><span class="hl-3">.</span><span class="hl-4">all</span><span class="hl-3">(</span><span class="hl-7">&quot;*&quot;</span><span class="hl-3">, (</span><span class="hl-2">req</span><span class="hl-3">: </span><span class="hl-5">Request</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">: </span><span class="hl-5">Response</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">501</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">});</span>
</code></pre>
<p>Este código define un enrutador por defecto usando el framework de Node.js llamado Express. El enrutador se crea utilizando el método <code>express.Router()</code>. Luego se define una función manejadora para todas las peticiones HTTP que no han sido manejadas por otro enrutador. Esta función se registra para todas las rutas utilizando el método <code>all()</code>.</p>
<p>La función manejadora simplemente establece un código de estado HTTP 501 (&quot;No implementado&quot;) y envía la respuesta al cliente. En resumen, este enrutador manejará todas las peticiones no encontradas en otras rutas definidas en la aplicación y responderá con un estado 501.</p>
<p>El codigo del fichero group.ts es:</p>
<pre><code class="language-ts"><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Module for handling routes related to groups</span><br/><span class="hl-1">@module</span><span class="hl-0"> </span><span class="hl-5">groupRouter</span><br/><span class="hl-0">*/</span><br/><span class="hl-6">import</span><span class="hl-3"> </span><span class="hl-2">express</span><span class="hl-3"> </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;express&quot;</span><span class="hl-3">;</span><br/><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">GroupModel</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;../models/group.js&quot;</span><span class="hl-3">;</span><br/><br/><span class="hl-0">/** Express router for groups */</span><br/><span class="hl-6">export</span><span class="hl-3"> </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">groupRouter</span><span class="hl-3"> = </span><span class="hl-2">express</span><span class="hl-3">.</span><span class="hl-4">Router</span><span class="hl-3">();</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Route for creating a new group</span><br/><span class="hl-1">@name</span><span class="hl-0"> </span><span class="hl-5">post/groups</span><br/><span class="hl-1">@function</span><br/><span class="hl-1">@memberof</span><span class="hl-0"> </span><span class="hl-5">module:groupRouter</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">req</span><span class="hl-0"> - Express request object</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">req.body</span><span class="hl-0"> - Request body containing the group&#39;s data</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{string}</span><span class="hl-0"> </span><span class="hl-2">req.body.name</span><span class="hl-0"> - The name of the group</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Array}</span><span class="hl-0"> </span><span class="hl-2">req.body.members</span><span class="hl-0"> - An array of user IDs representing members of the group</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">req.body.global_statistics</span><span class="hl-0"> - An object containing global statistics for the group</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Array}</span><span class="hl-0"> </span><span class="hl-2">req.body.ranking</span><span class="hl-0"> - An array of user IDs representing the group&#39;s ranking</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Array}</span><span class="hl-0"> </span><span class="hl-2">req.body.favorite_tracks</span><span class="hl-0"> - An array of track IDs representing the group&#39;s favorite tracks</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Array}</span><span class="hl-0"> </span><span class="hl-2">req.body.group_history</span><span class="hl-0"> - An array of objects representing the group&#39;s history</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">res</span><span class="hl-0"> - Express response object</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> Returns the newly created group or an error</span><br/><span class="hl-1">@throws</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> Throws an error if the group creation fails</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">groupRouter</span><span class="hl-3">.</span><span class="hl-4">post</span><span class="hl-3">(</span><span class="hl-7">&quot;/groups&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">group</span><span class="hl-3"> = </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">GroupModel</span><span class="hl-3">(</span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">body</span><span class="hl-3">);</span><br/><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">group</span><span class="hl-3">.</span><span class="hl-4">save</span><span class="hl-3">();</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">201</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">group</span><span class="hl-3">);</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Route for finding a group or groups by name</span><br/><span class="hl-1">@name</span><span class="hl-0"> </span><span class="hl-5">get/groups</span><br/><span class="hl-1">@function</span><br/><span class="hl-1">@memberof</span><span class="hl-0"> </span><span class="hl-5">module:groupRouter</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">req</span><span class="hl-0"> - Express request object</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{string}</span><span class="hl-0"> </span><span class="hl-2">req.query.name</span><span class="hl-0"> - The name of the group to find</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">res</span><span class="hl-0"> - Express response object</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> Returns the found group or groups or an error</span><br/><span class="hl-1">@throws</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> Throws an error if the find operation fails</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">groupRouter</span><span class="hl-3">.</span><span class="hl-4">get</span><span class="hl-3">(</span><span class="hl-7">&quot;/groups&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">filter</span><span class="hl-3"> = </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3"> ? { </span><span class="hl-2">name:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3">.</span><span class="hl-4">toString</span><span class="hl-3">() } : {};</span><br/><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">groups</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">GroupModel</span><span class="hl-3">.</span><span class="hl-4">findOne</span><span class="hl-3">(</span><span class="hl-2">filter</span><span class="hl-3">);</span><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">groups</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">groups</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Route for finding a group by ID</span><br/><span class="hl-1">@name</span><span class="hl-0"> </span><span class="hl-5">get/groups/:id</span><br/><span class="hl-1">@function</span><br/><span class="hl-1">@memberof</span><span class="hl-0"> </span><span class="hl-5">module:groupRouter</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">req</span><span class="hl-0"> - Express request object</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{string}</span><span class="hl-0"> </span><span class="hl-2">req.params.id</span><span class="hl-0"> - The ID of the group to find</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">res</span><span class="hl-0"> - Express response object</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> Returns the found group or an error</span><br/><span class="hl-1">@throws</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> Throws an error if the find operation fails</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">groupRouter</span><span class="hl-3">.</span><span class="hl-4">get</span><span class="hl-3">(</span><span class="hl-7">&quot;/groups/:id&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">groups</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">GroupModel</span><span class="hl-3">.</span><span class="hl-4">find</span><span class="hl-3">({</span><br/><span class="hl-3">      </span><span class="hl-2">id:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">params</span><span class="hl-3">.</span><span class="hl-2">id</span><span class="hl-3">,</span><br/><span class="hl-3">    });</span><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">groups</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">groups</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * </span><span class="hl-1">@route</span><span class="hl-0"> PATCH /groups</span><br/><span class="hl-0"> * </span><span class="hl-1">@group</span><span class="hl-0"> Groups - Operaciones CRUD para grupos</span><br/><span class="hl-0"> * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{string}</span><span class="hl-0"> </span><span class="hl-2">name.query.required</span><span class="hl-0"> - Nombre del grupo a actualizar.</span><br/><span class="hl-0"> * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Group.model}</span><span class="hl-0"> </span><span class="hl-2">body.required</span><span class="hl-0"> - Información actualizada del grupo.</span><br/><span class="hl-0"> * </span><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Group.model}</span><span class="hl-0"> 200 - Grupo actualizado.</span><br/><span class="hl-0"> * </span><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> 400 - No se proporcionó el nombre del grupo.</span><br/><span class="hl-0"> * </span><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> 400 - Actualizaciones inválidas.</span><br/><span class="hl-0"> * </span><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> 404 - No se encontró el grupo especificado.</span><br/><span class="hl-0"> * </span><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> 500 - Error interno del servidor.</span><br/><span class="hl-0"> */</span><br/><span class="hl-2">groupRouter</span><span class="hl-3">.</span><span class="hl-4">patch</span><span class="hl-3">(</span><span class="hl-7">&quot;/groups&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">if</span><span class="hl-3"> (!</span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">400</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">({ </span><span class="hl-2">error:</span><span class="hl-3"> </span><span class="hl-7">&quot;No name provided&quot;</span><span class="hl-3"> });</span><br/><span class="hl-3">  }</span><br/><br/><span class="hl-3">  </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">allowedUpdates</span><span class="hl-3"> = </span><span class="hl-2">Object</span><span class="hl-3">.</span><span class="hl-4">keys</span><span class="hl-3">(</span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">body</span><span class="hl-3">);</span><br/><span class="hl-3">  </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">actualUpdates</span><span class="hl-3"> = [</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;id&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;name&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;members&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;global_stadistics&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;ranking&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;favorite_tracks&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;group_history&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">  ];</span><br/><br/><span class="hl-3">  </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">isValidOperation</span><span class="hl-3"> = </span><span class="hl-2">actualUpdates</span><span class="hl-3">.</span><span class="hl-4">every</span><span class="hl-3">((</span><span class="hl-2">update</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><br/><span class="hl-3">    </span><span class="hl-2">allowedUpdates</span><span class="hl-3">.</span><span class="hl-4">includes</span><span class="hl-3">(</span><span class="hl-2">update</span><span class="hl-3">)</span><br/><span class="hl-3">  );</span><br/><br/><span class="hl-3">  </span><span class="hl-6">if</span><span class="hl-3"> (!</span><span class="hl-2">isValidOperation</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">400</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">({ </span><span class="hl-2">error:</span><span class="hl-3"> </span><span class="hl-7">&quot;Invalid updates&quot;</span><span class="hl-3"> });</span><br/><span class="hl-3">  }</span><br/><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">group</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">GroupModel</span><span class="hl-3">.</span><span class="hl-4">findOneAndUpdate</span><span class="hl-3">(</span><br/><span class="hl-3">      { </span><span class="hl-2">name:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3">.</span><span class="hl-4">toString</span><span class="hl-3">() },</span><br/><span class="hl-3">      </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">body</span><span class="hl-3">,</span><br/><span class="hl-3">      { </span><span class="hl-2">new:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">, </span><span class="hl-2">runValidators:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3"> }</span><br/><span class="hl-3">    );</span><br/><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">group</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">group</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><br/><span class="hl-0">/**</span><br/><span class="hl-0"> * </span><span class="hl-1">@route</span><span class="hl-0"> PATCH /groups/:id</span><br/><span class="hl-0"> * </span><span class="hl-1">@group</span><span class="hl-0"> Groups - Operaciones CRUD para grupos</span><br/><span class="hl-0"> * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{string}</span><span class="hl-0"> </span><span class="hl-2">id.path.required</span><span class="hl-0"> - Identificador del grupo a actualizar.</span><br/><span class="hl-0"> * </span><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Group.model}</span><span class="hl-0"> </span><span class="hl-2">body.required</span><span class="hl-0"> - Información actualizada del grupo.</span><br/><span class="hl-0"> * </span><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Group.model}</span><span class="hl-0"> 200 - Grupo actualizado.</span><br/><span class="hl-0"> * </span><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> 404 - No se encontró el grupo especificado.</span><br/><span class="hl-0"> * </span><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> 500 - Error interno del servidor.</span><br/><span class="hl-0"> */</span><br/><span class="hl-2">groupRouter</span><span class="hl-3">.</span><span class="hl-4">patch</span><span class="hl-3">(</span><span class="hl-7">&quot;/groups/:id&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">group</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">GroupModel</span><span class="hl-3">.</span><span class="hl-4">findOneAndUpdate</span><span class="hl-3">(</span><br/><span class="hl-3">      { </span><span class="hl-2">id:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">params</span><span class="hl-3">.</span><span class="hl-2">id</span><span class="hl-3"> },</span><br/><span class="hl-3">      </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">body</span><span class="hl-3">,</span><br/><span class="hl-3">      { </span><span class="hl-2">new:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">, </span><span class="hl-2">runValidators:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3"> }</span><br/><span class="hl-3">    );</span><br/><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">group</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">group</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Deletes a group by its name</span><br/><span class="hl-1">@route</span><span class="hl-0"> DELETE /groups</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{string}</span><span class="hl-0"> </span><span class="hl-2">name.query.required</span><span class="hl-0"> - name of the group to delete</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> 200 - Deleted group</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> 404 - Group not found</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> 400 - Bad request</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> 500 - Internal server error</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">groupRouter</span><span class="hl-3">.</span><span class="hl-4">delete</span><span class="hl-3">(</span><span class="hl-7">&quot;/groups&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">if</span><span class="hl-3"> (!</span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">400</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">group</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">GroupModel</span><span class="hl-3">.</span><span class="hl-4">findOneAndDelete</span><span class="hl-3">({</span><br/><span class="hl-3">      </span><span class="hl-2">name:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3">,</span><br/><span class="hl-3">    });</span><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">group</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">group</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Deletes a group by its id</span><br/><span class="hl-1">@route</span><span class="hl-0"> DELETE /groups/{id}</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{string}</span><span class="hl-0"> </span><span class="hl-2">id.path.required</span><span class="hl-0"> - id of the group to delete</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> 200 - Deleted group</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> 404 - Group not found</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> 500 - Internal server error</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">groupRouter</span><span class="hl-3">.</span><span class="hl-4">delete</span><span class="hl-3">(</span><span class="hl-7">&quot;/groups/:id&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">group</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">GroupModel</span><span class="hl-3">.</span><span class="hl-4">findOneAndDelete</span><span class="hl-3">({</span><br/><span class="hl-3">      </span><span class="hl-2">id:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">params</span><span class="hl-3">.</span><span class="hl-2">id</span><span class="hl-3">,</span><br/><span class="hl-3">    });</span><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">group</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">group</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span>
</code></pre>
<p>El código es un archivo de módulo de Node.js que maneja las rutas relacionadas con los grupos. Utiliza el framework Express para definir un enrutador que se encarga de manejar peticiones HTTP para crear, buscar y actualizar grupos en una base de datos MongoDB.</p>
<p>El archivo comienza importando el módulo Express y el modelo de datos GroupModel. Luego, define el enrutador de Express para manejar las solicitudes relacionadas con los grupos.</p>
<p>A continuación, hay cuatro rutas definidas en el enrutador. La primera ruta maneja solicitudes POST para crear un nuevo grupo en la base de datos. La segunda ruta maneja solicitudes GET para buscar grupos por nombre. La tercera ruta maneja solicitudes GET para buscar un grupo por ID. Finalmente, las dos últimas rutas manejan solicitudes PATCH para actualizar grupos, una usando el nombre del grupo y la otra usando el ID del grupo.</p>
<p>En cada ruta, se maneja la solicitud y se devuelve una respuesta apropiada según el éxito o el error en la operación.</p>
<p>El codigo del fichero track.ts es:</p>
<pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-3"> </span><span class="hl-2">express</span><span class="hl-3"> </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;express&quot;</span><span class="hl-3">;</span><br/><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">TrackModel</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;../models/track.js&quot;</span><span class="hl-3">;</span><br/><br/><span class="hl-6">export</span><span class="hl-3"> </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">trackRouter</span><span class="hl-3"> = </span><span class="hl-2">express</span><span class="hl-3">.</span><span class="hl-4">Router</span><span class="hl-3">();</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Route for creating a new track resource.</span><br/><span class="hl-1">@name</span><span class="hl-0"> </span><span class="hl-5">POST</span><span class="hl-0"> /tracks</span><br/><span class="hl-1">@function</span><br/><span class="hl-1">@memberof</span><span class="hl-0"> </span><span class="hl-5">module:TrackRouter</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Request}</span><span class="hl-0"> </span><span class="hl-2">req</span><span class="hl-0"> - Express request object.</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Response}</span><span class="hl-0"> </span><span class="hl-2">res</span><span class="hl-0"> - Express response object.</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Response}</span><span class="hl-0"> Returns a JSON object representing the new track if successful, or an error response if unsuccessful.</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">trackRouter</span><span class="hl-3">.</span><span class="hl-4">post</span><span class="hl-3">(</span><span class="hl-7">&quot;/tracks&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">track</span><span class="hl-3"> = </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">TrackModel</span><span class="hl-3">(</span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">body</span><span class="hl-3">);</span><br/><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">track</span><span class="hl-3">.</span><span class="hl-4">save</span><span class="hl-3">();</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">201</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">track</span><span class="hl-3">);</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Route for retrieving track resources.</span><br/><span class="hl-1">@name</span><span class="hl-0"> </span><span class="hl-5">GET</span><span class="hl-0"> /tracks</span><br/><span class="hl-1">@function</span><br/><span class="hl-1">@memberof</span><span class="hl-0"> </span><span class="hl-5">module:TrackRouter</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Request}</span><span class="hl-0"> </span><span class="hl-2">req</span><span class="hl-0"> - Express request object.</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Response}</span><span class="hl-0"> </span><span class="hl-2">res</span><span class="hl-0"> - Express response object.</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Response}</span><span class="hl-0"> Returns a JSON object representing the requested tracks if successful, or an error response if unsuccessful.</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">trackRouter</span><span class="hl-3">.</span><span class="hl-4">get</span><span class="hl-3">(</span><span class="hl-7">&quot;/tracks&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">filter</span><span class="hl-3"> = </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3"> ? { </span><span class="hl-2">name:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3">.</span><span class="hl-4">toString</span><span class="hl-3">() } : {};</span><br/><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">tracks</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">TrackModel</span><span class="hl-3">.</span><span class="hl-4">findOne</span><span class="hl-3">(</span><span class="hl-2">filter</span><span class="hl-3">);</span><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">tracks</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">tracks</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Route for retrieving a specific track resource by ID.</span><br/><span class="hl-1">@name</span><span class="hl-0"> </span><span class="hl-5">GET</span><span class="hl-0"> /tracks/:id</span><br/><span class="hl-1">@function</span><br/><span class="hl-1">@memberof</span><span class="hl-0"> </span><span class="hl-5">module:TrackRouter</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Request}</span><span class="hl-0"> </span><span class="hl-2">req</span><span class="hl-0"> - Express request object.</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Response}</span><span class="hl-0"> </span><span class="hl-2">res</span><span class="hl-0"> - Express response object.</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Response}</span><span class="hl-0"> Returns a JSON object representing the requested track if successful, or an error response if unsuccessful.</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">trackRouter</span><span class="hl-3">.</span><span class="hl-4">get</span><span class="hl-3">(</span><span class="hl-7">&quot;/tracks/:id&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">tracks</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">TrackModel</span><span class="hl-3">.</span><span class="hl-4">findOne</span><span class="hl-3">({</span><br/><span class="hl-3">      </span><span class="hl-2">id:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">params</span><span class="hl-3">.</span><span class="hl-2">id</span><span class="hl-3">,</span><br/><span class="hl-3">    });</span><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">tracks</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">tracks</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Route for updating track resources.</span><br/><span class="hl-1">@name</span><span class="hl-0"> </span><span class="hl-5">PATCH</span><span class="hl-0"> /tracks</span><br/><span class="hl-1">@function</span><br/><span class="hl-1">@memberof</span><span class="hl-0"> </span><span class="hl-5">module:TrackRouter</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Request}</span><span class="hl-0"> </span><span class="hl-2">req</span><span class="hl-0"> - Express request object.</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Response}</span><span class="hl-0"> </span><span class="hl-2">res</span><span class="hl-0"> - Express response object.</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Response}</span><span class="hl-0"> Returns a JSON object representing the updated track if successful, or an error response if unsuccessful.</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">trackRouter</span><span class="hl-3">.</span><span class="hl-4">patch</span><span class="hl-3">(</span><span class="hl-7">&quot;/tracks&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">if</span><span class="hl-3"> (!</span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">400</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">({ </span><span class="hl-2">error:</span><span class="hl-3"> </span><span class="hl-7">&quot;No name provided&quot;</span><span class="hl-3"> });</span><br/><span class="hl-3">  }</span><br/><br/><span class="hl-3">  </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">allowedUpdates</span><span class="hl-3"> = </span><span class="hl-2">Object</span><span class="hl-3">.</span><span class="hl-4">keys</span><span class="hl-3">(</span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">body</span><span class="hl-3">);</span><br/><span class="hl-3">  </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">actualUpdates</span><span class="hl-3"> = [</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;id&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;name&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;start&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;end&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;long&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;grade&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;users&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;type&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;puntuation&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">  ];</span><br/><br/><span class="hl-3">  </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">isValidUpdate</span><span class="hl-3"> = </span><span class="hl-2">allowedUpdates</span><span class="hl-3">.</span><span class="hl-4">every</span><span class="hl-3">((</span><span class="hl-2">update</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><br/><span class="hl-3">    </span><span class="hl-2">actualUpdates</span><span class="hl-3">.</span><span class="hl-4">includes</span><span class="hl-3">(</span><span class="hl-2">update</span><span class="hl-3">)</span><br/><span class="hl-3">  );</span><br/><br/><span class="hl-3">  </span><span class="hl-6">if</span><span class="hl-3"> (!</span><span class="hl-2">isValidUpdate</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">400</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">({ </span><span class="hl-2">error:</span><span class="hl-3"> </span><span class="hl-7">&quot;Invalid update&quot;</span><span class="hl-3"> });</span><br/><span class="hl-3">  }</span><br/><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">track</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">TrackModel</span><span class="hl-3">.</span><span class="hl-4">findOneAndUpdate</span><span class="hl-3">(</span><br/><span class="hl-3">      { </span><span class="hl-2">name:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3">.</span><span class="hl-4">toString</span><span class="hl-3">() },</span><br/><span class="hl-3">      </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">body</span><span class="hl-3">,</span><br/><span class="hl-3">      { </span><span class="hl-2">new:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">, </span><span class="hl-2">runValidators:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3"> }</span><br/><span class="hl-3">    );</span><br/><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">track</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">track</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Updates a track by id</span><br/><br/><span class="hl-1">@method</span><span class="hl-0"> </span><span class="hl-5">PATCH</span><br/><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{string}</span><span class="hl-0"> </span><span class="hl-2">req.params.id</span><span class="hl-0"> - The id of the track to be updated.</span><br/><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">req.body</span><span class="hl-0"> - The data to update the track with.</span><br/><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> The updated track.</span><br/><br/><span class="hl-1">@throws</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> If there was an error updating the track.</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">trackRouter</span><span class="hl-3">.</span><span class="hl-4">patch</span><span class="hl-3">(</span><span class="hl-7">&quot;/tracks/:id&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">track</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">TrackModel</span><span class="hl-3">.</span><span class="hl-4">findOneAndUpdate</span><span class="hl-3">(</span><br/><span class="hl-3">      { </span><span class="hl-2">id:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">params</span><span class="hl-3">.</span><span class="hl-2">id</span><span class="hl-3"> },</span><br/><span class="hl-3">      </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">body</span><span class="hl-3">,</span><br/><span class="hl-3">      { </span><span class="hl-2">new:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">, </span><span class="hl-2">runValidators:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3"> }</span><br/><span class="hl-3">    );</span><br/><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">track</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">track</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Deletes a track by name</span><br/><span class="hl-1">@method</span><span class="hl-0"> </span><span class="hl-5">DELETE</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{string}</span><span class="hl-0"> </span><span class="hl-2">req.query.name</span><span class="hl-0"> - The name of the track to be deleted.</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> The deleted track.</span><br/><span class="hl-1">@throws</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> If there was an error deleting the track.</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">trackRouter</span><span class="hl-3">.</span><span class="hl-4">delete</span><span class="hl-3">(</span><span class="hl-7">&quot;/tracks&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">if</span><span class="hl-3"> (!</span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">400</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">track</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">TrackModel</span><span class="hl-3">.</span><span class="hl-4">findOneAndDelete</span><span class="hl-3">({</span><br/><span class="hl-3">      </span><span class="hl-2">name:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3">,</span><br/><span class="hl-3">    });</span><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">track</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">track</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Deletes a track by id</span><br/><span class="hl-1">@method</span><span class="hl-0"> </span><span class="hl-5">DELETE</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{string}</span><span class="hl-0"> </span><span class="hl-2">req.params.id</span><span class="hl-0"> - The id of the track to be deleted.</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> The deleted track.</span><br/><span class="hl-1">@throws</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> If there was an error deleting the track.</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">trackRouter</span><span class="hl-3">.</span><span class="hl-4">delete</span><span class="hl-3">(</span><span class="hl-7">&quot;/tracks/:id&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">track</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">TrackModel</span><span class="hl-3">.</span><span class="hl-4">findOneAndDelete</span><span class="hl-3">({</span><br/><span class="hl-3">      </span><span class="hl-2">id:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">params</span><span class="hl-3">.</span><span class="hl-2">id</span><span class="hl-3">,</span><br/><span class="hl-3">    });</span><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">track</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">track</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span>
</code></pre>
<p>Este código define un enrutador (<code>trackRouter</code>) para una aplicación Express que maneja solicitudes para una colección de &quot;tracks&quot; (pistas o canciones). Los métodos disponibles son los siguientes:</p>
<ul>
<li>POST /tracks: crea una nueva pista con los datos proporcionados en el cuerpo de la solicitud. Retorna un objeto JSON representando la nueva pista si tiene éxito, o una respuesta de error si falla.</li>
<li>GET /tracks: recupera una lista de pistas. Si se proporciona el parámetro <code>name</code> en la cadena de consulta de la solicitud, se filtran las pistas por ese nombre. Retorna un objeto JSON representando las pistas solicitadas si tiene éxito, o una respuesta de error si falla.</li>
<li>GET /tracks/:id: recupera una pista específica según su identificador <code>id</code>. Retorna un objeto JSON representando la pista solicitada si tiene éxito, o una respuesta de error si falla.</li>
<li>PATCH /tracks y PATCH /tracks/:id: actualiza una o varias propiedades de una pista, identificada por el parámetro <code>name</code> o <code>id</code> de la solicitud, respectivamente. Retorna un objeto JSON representando la pista actualizada si tiene éxito, o una respuesta de error si falla.</li>
<li>DELETE /tracks y DELETE /tracks/:id: elimina una pista, identificada por el parámetro <code>name</code> o <code>id</code> de la solicitud, respectivamente. Retorna un objeto JSON representando la pista eliminada si tiene éxito, o una respuesta de error si falla.</li>
</ul>
<p>El enrutador depende del modelo <code>TrackModel</code> que se importa desde &quot;../models/track.js&quot;, el cual se supone que define la estructura de datos para las pistas de la aplicación. Además, se utiliza el middleware <code>express.Router()</code> para definir las rutas de la aplicación.</p>
<p>El codigo del fichero user.ts es:</p>
<pre><code class="language-ts"><span class="hl-0">//sudo /home/usuario/mongodb/bin/mongod --dbpath /home/usuario/mongodb-data/</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Router para manejar usuarios</span><br/><span class="hl-1">@class</span><br/><span class="hl-1">@typedef</span><span class="hl-0"> </span><span class="hl-5">{import(&#39;express&#39;).Router}</span><span class="hl-0"> </span><span class="hl-5">Router</span><br/><span class="hl-1">@property</span><span class="hl-0"> </span><span class="hl-5">{Router}</span><span class="hl-0"> </span><span class="hl-2">userRouter</span><span class="hl-0"> - Router para manejar usuarios</span><br/><span class="hl-0">*/</span><br/><span class="hl-6">import</span><span class="hl-3"> </span><span class="hl-2">express</span><span class="hl-3"> </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;express&quot;</span><span class="hl-3">;</span><br/><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">UserModel</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;../models/user.js&quot;</span><span class="hl-3">;</span><br/><br/><span class="hl-6">export</span><span class="hl-3"> </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">userRouter</span><span class="hl-3"> = </span><span class="hl-2">express</span><span class="hl-3">.</span><span class="hl-4">Router</span><span class="hl-3">();</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Crea un usuario nuevo</span><br/><span class="hl-1">@name</span><span class="hl-0"> </span><span class="hl-5">POST/users</span><br/><span class="hl-1">@function</span><br/><span class="hl-1">@memberof</span><span class="hl-0"> </span><span class="hl-5">userRouter</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">req</span><span class="hl-0"> - Objeto request de Express</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">req.body</span><span class="hl-0"> - Objeto que contiene los datos del usuario</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">res</span><span class="hl-0"> - Objeto response de Express</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> Objeto que contiene los datos del usuario creado</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">userRouter</span><span class="hl-3">.</span><span class="hl-4">post</span><span class="hl-3">(</span><span class="hl-7">&quot;/users&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">user</span><span class="hl-3"> = </span><span class="hl-1">new</span><span class="hl-3"> </span><span class="hl-4">UserModel</span><span class="hl-3">(</span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">body</span><span class="hl-3">);</span><br/><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">user</span><span class="hl-3">.</span><span class="hl-4">save</span><span class="hl-3">();</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">201</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">user</span><span class="hl-3">);</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Obtiene la información de todos los usuarios o de un usuario en particular</span><br/><span class="hl-1">@name</span><span class="hl-0"> </span><span class="hl-5">GET/users</span><br/><span class="hl-1">@function</span><br/><span class="hl-1">@memberof</span><span class="hl-0"> </span><span class="hl-5">userRouter</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">req</span><span class="hl-0"> - Objeto request de Express</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{String}</span><span class="hl-0"> </span><span class="hl-2">[req.query.name]</span><span class="hl-0"> - Nombre del usuario que se desea obtener</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">res</span><span class="hl-0"> - Objeto response de Express</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> Objeto que contiene la información del usuario o usuarios</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">userRouter</span><span class="hl-3">.</span><span class="hl-4">get</span><span class="hl-3">(</span><span class="hl-7">&quot;/users&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">filter</span><span class="hl-3"> = </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3"> ? { </span><span class="hl-2">name:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3">.</span><span class="hl-4">toString</span><span class="hl-3">() } : {};</span><br/><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">users</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">UserModel</span><span class="hl-3">.</span><span class="hl-4">findOne</span><span class="hl-3">(</span><span class="hl-2">filter</span><span class="hl-3">);</span><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">users</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">users</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Obtiene la información de un usuario en particular</span><br/><span class="hl-1">@name</span><span class="hl-0"> </span><span class="hl-5">GET/users/:id</span><br/><span class="hl-1">@function</span><br/><span class="hl-1">@memberof</span><span class="hl-0"> </span><span class="hl-5">userRouter</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">req</span><span class="hl-0"> - Objeto request de Express</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{String}</span><span class="hl-0"> </span><span class="hl-2">req.params.id</span><span class="hl-0"> - ID del usuario que se desea obtener</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">res</span><span class="hl-0"> - Objeto response de Express</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> Objeto que contiene la información del usuario</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">userRouter</span><span class="hl-3">.</span><span class="hl-4">get</span><span class="hl-3">(</span><span class="hl-7">&quot;/users/:id&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">users</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">UserModel</span><span class="hl-3">.</span><span class="hl-4">findOne</span><span class="hl-3">({</span><br/><span class="hl-3">      </span><span class="hl-2">id:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">params</span><span class="hl-3">.</span><span class="hl-2">id</span><span class="hl-3">,</span><br/><span class="hl-3">    });</span><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">users</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">users</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Actualiza los datos de un usuario</span><br/><span class="hl-1">@name</span><span class="hl-0"> </span><span class="hl-5">PATCH/users</span><br/><span class="hl-1">@function</span><br/><span class="hl-1">@memberof</span><span class="hl-0"> </span><span class="hl-5">userRouter</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">req</span><span class="hl-0"> - Objeto request de Express</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{String}</span><span class="hl-0"> </span><span class="hl-2">[req.query.name]</span><span class="hl-0"> - Nombre del usuario que se desea actualizar</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">req.body</span><span class="hl-0"> - Objeto que contiene los nuevos datos del usuario</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> </span><span class="hl-2">res</span><span class="hl-0"> - Objeto response de Express</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Object}</span><span class="hl-0"> Objeto que contiene la información del usuario actualizado</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">userRouter</span><span class="hl-3">.</span><span class="hl-4">patch</span><span class="hl-3">(</span><span class="hl-7">&quot;/users&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">if</span><span class="hl-3"> (!</span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">400</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">({ </span><span class="hl-2">error:</span><span class="hl-3"> </span><span class="hl-7">&quot;No name provided&quot;</span><span class="hl-3"> });</span><br/><span class="hl-3">  }</span><br/><br/><span class="hl-3">  </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">allowedUpdates</span><span class="hl-3"> = </span><span class="hl-2">Object</span><span class="hl-3">.</span><span class="hl-4">keys</span><span class="hl-3">(</span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">body</span><span class="hl-3">);</span><br/><span class="hl-3">  </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">actualUpdates</span><span class="hl-3"> = [</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;id&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;name&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;activity&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;friends&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;groups&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;statistics&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;favorite_tracks&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;challenges&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">    </span><span class="hl-7">&quot;history&quot;</span><span class="hl-3">,</span><br/><span class="hl-3">  ];</span><br/><br/><span class="hl-3">  </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">isValidOperation</span><span class="hl-3"> = </span><span class="hl-2">actualUpdates</span><span class="hl-3">.</span><span class="hl-4">every</span><span class="hl-3">((</span><span class="hl-2">update</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><br/><span class="hl-3">    </span><span class="hl-2">allowedUpdates</span><span class="hl-3">.</span><span class="hl-4">includes</span><span class="hl-3">(</span><span class="hl-2">update</span><span class="hl-3">)</span><br/><span class="hl-3">  );</span><br/><br/><span class="hl-3">  </span><span class="hl-6">if</span><span class="hl-3"> (!</span><span class="hl-2">isValidOperation</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">400</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">({ </span><span class="hl-2">error:</span><span class="hl-3"> </span><span class="hl-7">&quot;Invalid updates&quot;</span><span class="hl-3"> });</span><br/><span class="hl-3">  }</span><br/><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">user</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">UserModel</span><span class="hl-3">.</span><span class="hl-4">findOneAndUpdate</span><span class="hl-3">(</span><br/><span class="hl-3">      {</span><br/><span class="hl-3">        </span><span class="hl-2">name:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3">.</span><span class="hl-4">toString</span><span class="hl-3">(),</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">      </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">body</span><span class="hl-3">,</span><br/><span class="hl-3">      {</span><br/><span class="hl-3">        </span><span class="hl-2">new:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">        </span><span class="hl-2">runValidators:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      }</span><br/><span class="hl-3">    );</span><br/><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">user</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">user</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Patch a user with a given id.</span><br/><br/><span class="hl-1">@route</span><span class="hl-0"> PATCH /users/{id}</span><br/><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{string}</span><span class="hl-0"> </span><span class="hl-2">id.path.required</span><span class="hl-0"> - The id of the user to patch.</span><br/><br/><span class="hl-1">@body</span><span class="hl-0"> {object} user - The updated user object.</span><br/><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{object}</span><span class="hl-0"> 200 - The updated user.</span><br/><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> 404 - The user was not found.</span><br/><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> 500 - An error occurred while updating the user.</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">userRouter</span><span class="hl-3">.</span><span class="hl-4">patch</span><span class="hl-3">(</span><span class="hl-7">&quot;/users/:id&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">user</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">UserModel</span><span class="hl-3">.</span><span class="hl-4">findOneAndUpdate</span><span class="hl-3">(</span><br/><span class="hl-3">      {</span><br/><span class="hl-3">        </span><span class="hl-2">id:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">params</span><span class="hl-3">.</span><span class="hl-2">id</span><span class="hl-3">,</span><br/><span class="hl-3">      },</span><br/><span class="hl-3">      </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">body</span><span class="hl-3">,</span><br/><span class="hl-3">      {</span><br/><span class="hl-3">        </span><span class="hl-2">new:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">        </span><span class="hl-2">runValidators:</span><span class="hl-3"> </span><span class="hl-1">true</span><span class="hl-3">,</span><br/><span class="hl-3">      }</span><br/><span class="hl-3">    );</span><br/><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">user</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">user</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Delete a user with a given name.</span><br/><span class="hl-1">@route</span><span class="hl-0"> DELETE /users</span><br/><span class="hl-1">@queryparam</span><span class="hl-0"> {string} name - The name of the user to delete.</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{object}</span><span class="hl-0"> 200 - The deleted user.</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> 400 - No name provided.</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> 404 - The user was not found.</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> 500 - An error occurred while deleting the user.</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">userRouter</span><span class="hl-3">.</span><span class="hl-4">delete</span><span class="hl-3">(</span><span class="hl-7">&quot;/users&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">if</span><span class="hl-3"> (!</span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">400</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">user</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">UserModel</span><span class="hl-3">.</span><span class="hl-4">findOneAndDelete</span><span class="hl-3">({</span><br/><span class="hl-3">      </span><span class="hl-2">name:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">query</span><span class="hl-3">.</span><span class="hl-2">name</span><span class="hl-3">,</span><br/><span class="hl-3">    });</span><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">user</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">user</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span><br/><span class="hl-0">/**</span><br/><br/><span class="hl-0">Delete a user with a given id.</span><br/><span class="hl-1">@route</span><span class="hl-0"> DELETE /users/{id}</span><br/><span class="hl-1">@param</span><span class="hl-0"> </span><span class="hl-5">{string}</span><span class="hl-0"> </span><span class="hl-2">id.path.required</span><span class="hl-0"> - The id of the user to delete.</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{object}</span><span class="hl-0"> 200 - The deleted user.</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> 404 - The user was not found.</span><br/><span class="hl-1">@returns</span><span class="hl-0"> </span><span class="hl-5">{Error}</span><span class="hl-0"> 500 - An error occurred while deleting the user.</span><br/><span class="hl-0">*/</span><br/><span class="hl-2">userRouter</span><span class="hl-3">.</span><span class="hl-4">delete</span><span class="hl-3">(</span><span class="hl-7">&quot;/users/:id&quot;</span><span class="hl-3">, </span><span class="hl-1">async</span><span class="hl-3"> (</span><span class="hl-2">req</span><span class="hl-3">, </span><span class="hl-2">res</span><span class="hl-3">) </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-6">try</span><span class="hl-3"> {</span><br/><span class="hl-3">    </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">user</span><span class="hl-3"> = </span><span class="hl-6">await</span><span class="hl-3"> </span><span class="hl-2">UserModel</span><span class="hl-3">.</span><span class="hl-4">findOneAndDelete</span><span class="hl-3">({</span><br/><span class="hl-3">      </span><span class="hl-2">id:</span><span class="hl-3"> </span><span class="hl-2">req</span><span class="hl-3">.</span><span class="hl-2">params</span><span class="hl-3">.</span><span class="hl-2">id</span><span class="hl-3">,</span><br/><span class="hl-3">    });</span><br/><span class="hl-3">    </span><span class="hl-6">if</span><span class="hl-3"> (</span><span class="hl-2">user</span><span class="hl-3">) {</span><br/><span class="hl-3">      </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">user</span><span class="hl-3">);</span><br/><span class="hl-3">    }</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">404</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">();</span><br/><span class="hl-3">  } </span><span class="hl-6">catch</span><span class="hl-3"> (</span><span class="hl-2">error</span><span class="hl-3">) {</span><br/><span class="hl-3">    </span><span class="hl-6">return</span><span class="hl-3"> </span><span class="hl-2">res</span><span class="hl-3">.</span><span class="hl-4">status</span><span class="hl-3">(</span><span class="hl-9">500</span><span class="hl-3">).</span><span class="hl-4">send</span><span class="hl-3">(</span><span class="hl-2">error</span><span class="hl-3">);</span><br/><span class="hl-3">  }</span><br/><span class="hl-3">});</span>
</code></pre>
<p>Este código es un router que maneja las operaciones CRUD (crear, leer, actualizar y eliminar) para usuarios utilizando una base de datos MongoDB. </p>
<p>Primero, se importa el módulo express y el modelo de usuario definido en otro archivo. Luego se define el router de usuario utilizando la función <code>express.Router()</code>. </p>
<p>A continuación, se definen varias rutas que manejan diferentes operaciones:</p>
<ul>
<li><p>POST/users: crea un nuevo usuario utilizando los datos proporcionados en <code>req.body</code>. Si se crea el usuario con éxito, se devuelve un objeto que contiene los datos del usuario creado. Si hay algún error, se devuelve un código de estado 500 con el error correspondiente.</p>
</li>
<li><p>GET/users: obtiene la información de todos los usuarios o de un usuario en particular utilizando el parámetro <code>name</code> proporcionado en <code>req.query</code>. Si se encuentra el usuario o los usuarios con éxito, se devuelve un objeto que contiene la información de los usuarios. Si no se encuentra ningún usuario, se devuelve un código de estado 404.</p>
</li>
<li><p>GET/users/:id: obtiene la información de un usuario en particular utilizando el parámetro <code>id</code> proporcionado en <code>req.params</code>. Si se encuentra el usuario con éxito, se devuelve un objeto que contiene la información del usuario. Si no se encuentra ningún usuario, se devuelve un código de estado 404.</p>
</li>
<li><p>PATCH/users: actualiza los datos de un usuario utilizando el parámetro <code>name</code> proporcionado en <code>req.query</code> y los nuevos datos proporcionados en <code>req.body</code>. Si se actualiza el usuario con éxito, se devuelve un objeto que contiene los datos del usuario actualizado. Si hay algún error, se devuelve un código de estado 500 con el error correspondiente.</p>
</li>
<li><p>PATCH/users/:id: actualiza los datos de un usuario utilizando el parámetro <code>id</code> proporcionado en <code>req.params</code> y los nuevos datos proporcionados en <code>req.body</code>. Si se actualiza el usuario con éxito, se devuelve un objeto que contiene los datos del usuario actualizado. Si hay algún error, se devuelve un código de estado 500 con el error correspondiente.</p>
</li>
<li><p>DELETE/users: elimina un usuario utilizando el parámetro <code>name</code> proporcionado en <code>req.query</code>. Si se elimina el usuario con éxito, se devuelve un objeto que contiene los datos del usuario eliminado. Si hay algún error, se devuelve un código de estado 500 con el error correspondiente.</p>
</li>
</ul>

<a href="#otros-ficheros" id="otros-ficheros" style="color: inherit; text-decoration: none;">
  <h3>Otros ficheros</h3>
</a>
<p>El codigo del fichero app.ts es:</p>
<pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-3"> </span><span class="hl-2">express</span><span class="hl-3"> </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;express&quot;</span><span class="hl-3">;</span><br/><span class="hl-6">import</span><span class="hl-3"> </span><span class="hl-7">&quot;./db/mongoose.js&quot;</span><span class="hl-3">;</span><br/><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">userRouter</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;./routers/user.js&quot;</span><span class="hl-3">;</span><br/><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">trackRouter</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;./routers/track.js&quot;</span><span class="hl-3">;</span><br/><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">groupRouter</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;./routers/group.js&quot;</span><span class="hl-3">;</span><br/><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">challengeRouter</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;./routers/challenge.js&quot;</span><span class="hl-3">;</span><br/><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">defaultRouter</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;./routers/default.js&quot;</span><span class="hl-3">;</span><br/><br/><span class="hl-6">export</span><span class="hl-3"> </span><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">app</span><span class="hl-3"> = </span><span class="hl-4">express</span><span class="hl-3">();</span><br/><span class="hl-2">app</span><span class="hl-3">.</span><span class="hl-4">use</span><span class="hl-3">(</span><span class="hl-2">express</span><span class="hl-3">.</span><span class="hl-4">json</span><span class="hl-3">());</span><br/><span class="hl-2">app</span><span class="hl-3">.</span><span class="hl-4">use</span><span class="hl-3">(</span><span class="hl-2">trackRouter</span><span class="hl-3">);</span><br/><span class="hl-2">app</span><span class="hl-3">.</span><span class="hl-4">use</span><span class="hl-3">(</span><span class="hl-2">userRouter</span><span class="hl-3">);</span><br/><span class="hl-2">app</span><span class="hl-3">.</span><span class="hl-4">use</span><span class="hl-3">(</span><span class="hl-2">groupRouter</span><span class="hl-3">);</span><br/><span class="hl-2">app</span><span class="hl-3">.</span><span class="hl-4">use</span><span class="hl-3">(</span><span class="hl-2">challengeRouter</span><span class="hl-3">);</span><br/><span class="hl-2">app</span><span class="hl-3">.</span><span class="hl-4">use</span><span class="hl-3">(</span><span class="hl-2">defaultRouter</span><span class="hl-3">);</span>
</code></pre>
<p>Este código importa el módulo <code>express</code> para crear una aplicación web y se utiliza para definir rutas en diferentes módulos. </p>
<p>Luego, importa los siguientes módulos de ruta:</p>
<ul>
<li><code>userRouter</code>: para definir las rutas de usuario.</li>
<li><code>trackRouter</code>: para definir las rutas de seguimiento.</li>
<li><code>groupRouter</code>: para definir las rutas de grupo.</li>
<li><code>challengeRouter</code>: para definir las rutas de desafío.</li>
<li><code>defaultRouter</code>: para definir las rutas predeterminadas.</li>
</ul>
<p>Por último, se crea una instancia de la aplicación <code>express</code> y se utiliza el método <code>use()</code> para asociar cada uno de los enrutadores importados a la aplicación. Además, se utiliza el método <code>json()</code> de la instancia de <code>express</code> para analizar el cuerpo de las solicitudes entrantes como objetos JSON. </p>
<p>En resumen, este código es una aplicación de servidor web que utiliza diferentes módulos de ruta para manejar las solicitudes entrantes en diferentes rutas.</p>
<p>El codigo del fichero index.ts es:</p>
<pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-3"> { </span><span class="hl-2">app</span><span class="hl-3"> } </span><span class="hl-6">from</span><span class="hl-3"> </span><span class="hl-7">&quot;./app.js&quot;</span><span class="hl-3">;</span><br/><br/><span class="hl-1">const</span><span class="hl-3"> </span><span class="hl-8">port</span><span class="hl-3"> = </span><span class="hl-2">process</span><span class="hl-3">.</span><span class="hl-2">env</span><span class="hl-3">.</span><span class="hl-8">PORT</span><span class="hl-3"> || </span><span class="hl-9">3000</span><span class="hl-3">;</span><br/><br/><span class="hl-2">app</span><span class="hl-3">.</span><span class="hl-4">listen</span><span class="hl-3">(</span><span class="hl-2">port</span><span class="hl-3">, () </span><span class="hl-1">=&gt;</span><span class="hl-3"> {</span><br/><span class="hl-3">  </span><span class="hl-2">console</span><span class="hl-3">.</span><span class="hl-4">log</span><span class="hl-3">(</span><span class="hl-7">`Server is up on port </span><span class="hl-1">${</span><span class="hl-2">port</span><span class="hl-1">}</span><span class="hl-7">`</span><span class="hl-3">);</span><br/><span class="hl-3">});</span>
</code></pre>
<p>El código importa la constante &quot;app&quot; desde el archivo &quot;app.js&quot;, que es una instancia de la aplicación Express que se ha configurado con varios middlewares y enrutadores. Luego, se establece un valor para la variable &quot;port&quot; que se usará para escuchar las conexiones entrantes. Finalmente, la aplicación se inicia llamando al método &quot;listen&quot; en la instancia de &quot;app&quot;, pasando el valor del puerto y una función de devolución de llamada que se ejecutará cuando la aplicación comience a escuchar conexiones entrantes. La función de devolución de llamada simplemente imprime un mensaje en la consola indicando que el servidor está en ejecución y en qué puerto está escuchando. En resumen, este código inicia la aplicación y la hace escuchar en un puerto determinado.</p>

<a href="#conclusion" id="conclusion" style="color: inherit; text-decoration: none;">
  <h2>Conclusion</h2>
</a>

<a href="#referencias" id="referencias" style="color: inherit; text-decoration: none;">
  <h2>Referencias</h2>
</a>
</div></div>
<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
<div class="tsd-navigation settings">
<details class="tsd-index-accordion"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Settings</h3></summary>
<div class="tsd-accordion-details">
<div class="tsd-filter-visibility">
<h4 class="uppercase">Member Visibility</h4><form>
<ul id="tsd-filter-options">
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div>
<div class="tsd-theme-toggle">
<h4 class="uppercase">Theme</h4><select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div>
<nav class="tsd-navigation primary">
<details class="tsd-index-accordion" open><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Modules</h3></summary>
<div class="tsd-accordion-details">
<ul>
<li class="current selected"><a href="modules.html">doc-<wbr/>test</a>
<ul>
<li class="tsd-kind-module"><a href="modules/app.html">app</a></li>
<li class="tsd-kind-module"><a href="modules/index.html">index</a></li></ul></li></ul></div></details></nav></div></div>
<div class="container tsd-generator">
<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div>
<div class="overlay"></div><script src="assets/main.js"></script></body></html>